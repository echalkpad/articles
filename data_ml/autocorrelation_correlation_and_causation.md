# Autocorrelation, Correlation and Causation

[Original URL](http://macroquantpdx.tumblr.com/post/116656634625/autocorrelation-correlation-and-causation)

> April 17, 2015In this post I will illustrate some concepts in financial time series analysis that are routinely ignored. I will be getting a bit technical, but if you bear with me, I promise that it...

![image](https://40.media.tumblr.com/341be6b6b04c4c050c8dce34e333b39b/tumblr_inline_nmypvm6CvQ1t6na7b_1280.jpg) April 17, 2015

In this post I will illustrate some concepts in financial time series analysis that are routinely ignored. I will be getting a bit technical, but if you bear with me, I promise that it will be your worthwhile!

As an example, I will be analyzing whether China buying USTs impacts the USTs' returns. We will use two times series going back 100 months from today, one represents the monthly treasury purchases by China and the other represents the monthly price of $TLT since 2006\.

Time series charts are everywhere and they add great value to our understanding and visualization of asset prices. However they can also be misleading, especially when two time series are plotted on the same chart. Visually these two series on charts are presented as if there is some cause and effect relationship. Unfortunately the vast majority of financial time series are highly autocorrelated, and regressing one series against the other is guaranteed to show high R-squared (or correlation) values. In other words, implying causation by plotting two time series on a plot is misleading most of the time. The chart below shows the cumulative monthly USTs purchase by China against $TLT. These two series are indeed highly correlated as evident from the chart. The R-squared value is around 57% implying a high degree of correlation. But does this imply that China's buying is causing the $TLT to go higher? The answer is no, because high autocorrelation within each series, not the cause-effect, is causing high correlation between these two series.

![image](https://41.media.tumblr.com/9ad2a946e1343b6fdcebb4f1499d7698/tumblr_inline_nmypoqQOJL1t6na7b_1280.jpg) There is a simple and statistically correct way to deal with the problem of autocorrelation that causes multiple series on the same chart to be misleading. You can greatly improve your charts by simply taking a first difference* of each series and then plot both on the same chart. However, the first difference should make an economic sense. For example, taking a log of $TLT and then taking a first difference implies monthly returns. The first difference of Chinese gross USTs purchases implies net purchases.

The chart below shows $TLT monthly returns versus China's net purchase of USTs, but this time we are plotting the first difference. As you can see on the chart, there seems to be no relationship between China's buying and $TLT monthly returns. Running a regression between these modified series results in an R-squared value of around 7%, implying no correlation, a far cry from the previously observed high correlation of 57%.

![image](https://41.media.tumblr.com/f3068a00b412118a7de673e8e1df2dc0/tumblr_inline_nmypqgRgxQ1t6na7b_1280.jpg) Now if you are a statistician like me, you can go ahead and waste your time by being more rigorous! For such problems, you can perform a Granger cauaslity test or study cointegration between these series. In my opinion, as a trader, all you need to do is plot a differenced series to understand the relationship. Nine out of ten times, you are going to be pretty close to the results obtained by an "expert quant". If you want to be real fancy, just fire up excel, do a scatter plot of a differenced series, insert a linear model and observe the R-square value printed on the excel chart. A high R-squared value of a differenced series implies a high likelihood of a cause and effect relationship. If you have a solid theory and it matches with the high R-squared value you don't need to go any further.

*First difference just means tomorrow minus today, second difference means day-after-tomorrow minus today and so on. In other words, first difference is Xt+1 â€“ Xt and the second difference is Xt+2-Xt etc.
