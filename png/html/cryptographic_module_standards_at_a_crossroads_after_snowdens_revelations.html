<!DOCTYPE html><html><head><title>Cryptographic Module Standards at a Crossroads after Snowden’s Revelations</title></head><body>
<h1>Cryptographic Module Standards at a Crossroads after Snowden’s Revelations</h1><p><a href="http://pomcor.com/2015/11/12/cryptographic-module-standards-at-a-crossroads-after-snowdens-revelations/" target="_new">Original URL</a></p>
<p><blockquote>Last week I participated in the third International Cryptographic Module Conference (ICMC), organized by the Cryptographic Module User Forum (CMUF), and concerned with the validation of cryptographic&hellip;</blockquote></p>
<div><div class="entry-content">
						<p>
Last week I participated in the
<a href="http://icmconference.org/">third International Cryptographic
Module Conference (ICMC)</a>, organized by the Cryptographic Module
User Forum (CMUF), and concerned with the validation of cryptographic
modules against government and international standards. You may think
of cryptographic module validation as a dry topic, but it was quite an
exciting conference, full of technical and political controversy. The
technical controversy resulted from the fact that the standards are
out of sync with current technology and it is not at all clear how
they can be fixed. The political controversy resulted from the fact
that, after Snowden&#x2019;s revelations, it is not at all clear who should
try to fix them. The organizers signalled that they were not afraid
of controversy by inviting as keynote speakers both Phil Zimmerman,
creator of PHP and co-founder of Silent Circle, and Marianne Bailey,
Deputy CIO for Cybersecurity at the US Department of Defense, besides
well known expert Paul Kocher of SSL fame. I enjoyed an exchange
between Zimmerman and Bailey on the imbalance between defense and
offense at the NSA and its impact on cybersecurity. 
</p>

<p>
Besides the excitement, I liked the technical depth of the conference,
and was pleasantly surprised by the gender and ethnic diversity, which
was striking by contrast with Silicon Valley. The next ICMC will take
place earlier in the year, May 18-20, 2016, in Ottawa, and the
<a href="http://icmconference.org/?page_id=24">call for papers</a> is
already out.
</p>

<h2>Background</h2>

<p>
The conference was concerned with the design, implementation and
validation of cryptographic modules that conform with the 
<a href="http://csrc.nist.gov/publications/fips/fips140-2/fips1402.pdf">FIPS 140-2</a>
and ISO 19790:2012 standards. FIPS 140-2 is a Federal Information
Processing Standard issued by the US National Institute of Standards
and Technology (NIST). ISO 19790:2012 is an international standard
derived from FIPS 140-2, much of which is word-by-word identical to
FIPS 140-2. Cryptographic modules are validated as conforming to FIPS
140-2 by the
<a href="http://csrc.nist.gov/groups/STM/cmvp/">Cryptographic Module
Validation Program (CMVP)</a>, which is jointly managed by NIST and
the Communications Security Establishment Canada (CSEC) and relies on
an international network of Cryptography and Security Testing (CST)
labs spanning four continents. There is also a
<a href="http://csrc.nist.gov/groups/STM/cavp/">Cryptographic
Algorithm Validation Program (CAVP)</a> for the validation of
algorithms rather than modules.
</p>

<p>
Historically, NIST has been an internationally acknowledged leader in
cryptographic engineering. It organized international cryptographic
competitions that resulted in the specification of AES as the
worldwide de facto standard for symmetric encryption and SHA-3 as an
alternative to the NSA-designed family of hash functions SHA-2. CMVP
has been one of the successes of NIST in cryptographic leadership.
CMVP certification is widely sought after, not only for modules used
by Federal Agencies in the US and Canada, but also for modules used by
other governments and modules used for commercial purposes unrelated
to any government.
</p>


But the Snowden revelations regarding Dual EC DRBG, which Zimmerman
referred to in his keynote as having &#x201C;humiliated&#x201D; NIST,
have had an impact on the trust that the international cryptographic
community places in NIST, and given impetus to the development of
national cryptographic standards by countries other than the United
States. It will be difficult for NIST in the future to specify
cryptographic standards that are accepted worldwide. Hence the
question of who should fix the cryptographic module standards, which
are now widely seen as obsolete.


<h2>An obsolete standard</h2>

<p>
FIPS 140-2 is a revision of FIPS 140-1, which is itself a successor of
<a href="http://everyspec.com/FED-STD/FED-STD-1027_4688/">FED-STD-1027</a>, dated April 1982. FED-STD-1027 was renamed FIPS PUB 140
before being revised and issued in January 1994 as FIPS 140-1.
Federal Information Processing Standards (FIPS) are usually revised
every five years. FIPS 140-1 was issued in May 2001, with minor
changes over FIPS 140-2; but an attempt at making more radical changes
in FIPS 140-3 was abandoned after drafts in 2007 and 2009.
</p>

<p>
Besides being old, FIPS 140-2 is technically obsolete.
</p>

<p>
In the eighties, cryptography had to be implemented in hardware,
because software was too slow. FED-STD-1027 was only concerned with
hardware implementations. FIPS 140-1 and 140-2 allow software
implementations but only as an afterthought. They require a
cryptographic module to be contained within a <i>physical
boundary</i>, defined in FIPS 140-2 as <i>an explicitly defined
continuous perimeter that establishes the physical bounds of a
cryptographic module and contains all the hardware, software, and/or
firmware components of a cryptographic module</i>. Two sentences
attempt to reconcile the concept of a physical boundary with the
concept of a software cryptographic module in FIPS 140-2, but come up
short:
</p> 

<i>
<blockquote>
<p>
If a cryptographic module consists of software or firmware
components, the cryptographic boundary shall contain the processor(s)
and other hardware components that store and protect the software and
firmware components. Hardware, software, and firmware components of a
cryptographic module can be excluded from the requirements of this
standard if shown that these components do not affect the security of
the module.
</p>
</blockquote>
</i>

<p>
The concept of a cryptographic boundary is ill-defined for a software
module, and this is a source of insecurity in validated products. In
his presentation, Ashit Vora said that the cryptographic boundary may
be shrunk to exclude key management from validation, or to claim
compliance of OpenSSL with FIPS 140-2 even though the implementation
of TLS by OpenSSL has not been validated. I repeatedly heard
conference attendees refer to applying FIPS 140-2 to a software module
as &#x201C;<i>fitting a square peg into a round hole</i>&#x201D;.
</p>

<p>
Yet the first cryptographic module certified by CMVP was a software
module (the Entrust Cryptographic Kernel, V1.9, &#x201C;For use in
PCs&#x201D;, certified on October 12, 1995). FIPS 140-1 was already
obsolete in 1995, and FIPS 140-2, which made only minor changes, did
not bring it up to date.
</p>

<p>
Since then, the standard has become more and more out of sync with
technology, in spite of efforts to keep it up to date by issuing
<a href="http://csrc.nist.gov/groups/STM/cmvp/documents/fips140-2/FIPS1402IG.pdf">implementation
guidance</a>. Here are some examples. JavaScript programs are
interpreted by a web browser and run on any processor and operating
system on which the browser runs, yet an algorithm or module
implemented in JavaScript can only be certified for a specific
processor and operating system. Similarly, as pointed out by Apostol
Vassilev of NIST in response to a question after his presentation, a
cryptographic module implemented by software running on a virtual
server can only be certified for a particular version of the
hypervisor and a specific physical processor on which the hypervisor
runs. Mobile devices rely on encryption for protection of data and
keys, yet FIPS 140-2 does not allow encryption to be relied upon to
increase the security level. Mobile devices derive encryption keys
from a hardware root of trust or a cloud root of trust, but FIPS 140-2
only provides the option of deriving encryption keys from a password.
</p>

<p>
Also, the module validation process has not kept up with the
accelerating pace of technology evolution. As pointed out by Vassilev
in his presentation, certification review cycles are now much longer
than product cycles.
</p>

<h2>Benefits are not real</h2>

<p>
NIST speakers at the conference made it clear that they want to
replace FIPS 140-2 with ISO 19790 as the standard against which CMVP
validates cryptographic modules used by US Federal Agencies. Michael
Cooper of NIST, during his joint presentation with other NIST
speakers, said that NIST expects to submit a recommendation to that
effect to the Commerce Secretary as early as next month, after
finishing a review of comments on a Federal Register Notice proposing
the change.
</p>

<p>
At first glance, replacing FIPS 140-2 with ISO 19790 seems to be a
good solution to the problems facing cryptographic module validation.
It appears to provide two benefits:
</p>

<ol>

<li>
ISO 19790 is much more recent than FIPS 140-2, its second edition being dated
2012-08-15. (The Federal Register Notice refers to 19790:2014 but
there is no such thing. There is a 19790:2006, a.k.a. 19790 1st
Edition, a 19790:2012, a.k.a. 19790 2nd Edition, and a
<a href="https://webstore.iec.ch/publication/23401">Technical
Corrigendum</a> to 1790:2012 dated 2015-09-25.) Hence replacing FIPS
140-2 with ISO 19790 would appear to bring up to date the standard
used by CMVP.
</li>

<li>
ISO 19790 is an international standard. Hence using it in the CMVP
program would appear to solve the problem that will be faced by
vendors of cryptographic modules and testing laboratories as national
cryptographic standards proliferate.
</li>

</ol>

<p>
But neither benefit is real:
</p>

<ol>

<li>
Although the second edition of ISO 19790 is dated 2012, it only makes
minor modifications to FIPS 140-2 (which itself only made minor
modifications to the 1994 FIPS 140-1 standard, itself derived from the
1982 FED-STD-1027). ISO 19790 is as out of sync with current technology
as FIPS 140-2.
</li>

<li>
Although ISO 19790 is an international standard, NIST speakers said
that NIST intends to specify its own cryptographic algorithms in US
annexes, and issue its own implementation guidance, expecting other
countries to do the same. This will negate the benefits of ISO 19790
being an international standard for vendors and labs.
</li>

</ol>

<p>
And while the benefits are not real, ISO 19790 has real disadvantages:
it is bad policy, and it repeats a mistake that has been blamed for
the inclusion of Dual EC DRBG in SP 800-90A.
</p>

<h2>Bad policy</h2>

<p>
ISO charges a fee for downloading standards. Each document costs
hundreds of dollars, and each standard includes many ancillary
documents. In his presentation, Randall Easter, who holds positions
both at NIST and ISO, went over the ancillary documents related to ISO
19790; they include: ISO 17825, 18367, 19896-1, 19896-2, 20085-1,
20085-2, 20540, 20543, 2479 and 30104. In a comment after the talk,
an attendee estimated that his organization would have to spend
thousands of dollars on the documents. If ISO 19790 replaces FIPS
140-2, testing labs and vendors of cryptographic modules would have to
pay collectively millions of dollars to ISO. But development of the
ISO standard has been paid for with US taxpayer money, since much of
it is word-by-word identical to FIPS 140-2, and where the two
standards differ the changes have been made with NIST participation.
So US taxpayers would end up paying twice for the ISO standard, first
by financing the work of NIST on FIPS 140-2 and ISO 19790, and then by
bearing the cost of the documents, which labs and vendors will pass
along to US Federal Agencies that buy cryptographic modules conforming
to the standard.
</p>

<h2>Repeating the Dual EC DRBG mistake</h2>

<p>
NIST included a deterministic random bit generator (DRBG) known as
Dual EC DRBG, invented by the NSA, in the original version of
<a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-90Ar1.pdf">SP
800-90A</a>,
and removed it after stories in
<a href="http://www.nytimes.com/2013/09/06/us/nsa-foils-much-internet-encryption.html">The
New York Times</a>,
<a href="http://www.propublica.org/article/the-nsas-secret-campaign-to-crack-undermine-internet-encryption">ProPublica</a>,
and
<a href="http://www.theguardian.com/world/2013/sep/05/nsa-gchq-encryption-codes-security">The
Guardian</a>, referring to internal NSA memos leaked by Edward
Snowden, suggested that the NSA had planted a back door in the
algorithm.
</p>

<p>
Dual EC DRBG is a very simple algorithm, and the method for planting a
back door inside it is also very simple. They are described by
diagrams in slides 6 and 9 of a
<a href="http://csrc.nist.gov/groups/SMA/ispab/documents/minutes/2013-12/nist_cryptography_800-90.pdf">presentation</a>
by John Kelsey of NIST. <i>P</i> and <i>Q</i> being points of an
elliptic curve, pseudorandom bits are derived from <i>sQ</i>,
where <i>s</i> starts out as the seed and is replaced with <i>sP</i>
each time the DRBG is used. If <i>P</i> and <i>Q</i> are supplied by
an adversary instead of being random, the adversary can plant a back
door by letting <i>P</i> be <i>aQ</i>, where <i>a</i> is the back door
known to the adversary. The adversary can later compute the new
value <i>sP</i> assigned to <i>s</i> from <i>sQ</i>, since <i>sP</i>
= <i>s(aQ)</i> = <i>a(sQ)</i>. The adversary will not be able to
simply observe <i>sQ</i> as the algorithm is used, because the
algorithm only outputs a subset of the bits of the binary
representation of the abscissa of the point <i>sQ</i>. But only 16 of
the bits are not included in the subset, and the adversary can find
their values by making up to 2<sup>16</sup> guesses. To test a guess,
the adversary combines the guessed bits with the output bits to obtain
the abscissa of a point <i>R</i> of the curve, computes the ordinate
using the curve equation, computes <i>S</i> = <i>aR</i>, drops 16 bits
from the abscissa of <i>S</i>, and checks if the remaining bits agree
with the next output of the algorithm.
</p>

<p>
The back door <i>a</i> is a secret known only to the adversary. It is
unfeasible to compute the scalar <i>a</i> such that <i>P</i>
= <i>aQ</i> even though <i>P</i> and <i>Q</i> are public parameters
because discrete logarithms are supposed to be hard to compute in the
field of points of the elliptic curve. (If you are wondering what
discrete logarithms have to do with this, if the group operation were
metaphorically called multiplication instead of addition, <i>aQ</i>
would be written <i>Q<sup>a</sup></i> and called exponentiation
instead of scalar multiplication. With the multiplicative
notation, when <i>P</i> = <i>Q<sup>a</sup></i>, the exponent <i>a</i>
is said to be the logarithm of <i>P</i> in base <i>Q</i>,
&#x201C;discrete&#x201D; because the group is finite.)
</p>

<p>
How could such a simple back door make its way to SP 800-90A? It&#x2019;s a
long story with many twists and turns. An insider account can be
found in
<a href="http://csrc.nist.gov/groups/ST/crypto-review/documents/dualec_in_X982_and_sp800-90.pdf">another
presentation</a> by John Kelsey. Additional information can be found,
among other places,
in a
<a href="http://blog.cryptographyengineering.com/2013/12/a-few-more-notes-on-nsa-random-number.html">blog
post</a> by cryptographer Matthew Green, in this
<a href="https://projectbullrun.org/dual-ec/">web site dedicated
to Dual EC DRBG</a>, and in this
<a href="https://en.wikipedia.org/wiki/Dual_EC_DRBG">Wikipedia
page</a>.
</p>

<p>
But the root cause is clear. Dual EC DRBG was originally standardized
as part of the X9.82 standard developed by working group X9F1 of X9
with NIST participation. X9 is an ANSI-accredited organization that
develops financial services standards in the US and submits them to
ISO for international standardization. (X9.82 eventually became ISO
18031.) Like ISO and other ANSI-accredited standards organizations,
X9 is financed by membership fees and the sale of standards documents.
Consequently, its working groups work behind closed doors, and its
resulting standards receive little public scrutiny. This business
model for standards development works well for most kinds of business
and technical standards, but it does not work well for cryptography.
Cryptography requires transparency and extensive public scrutiny to
avoid the intentional or unintentional introduction of weaknesses in
standards. The international cryptographic competitions organized by
NIST to specify AES and SHA-3 are good examples of cryptographic
standards development with transparency and public scrutiny.
</p>

<p>
Here is what John Kelsey had to say about the development of the Dual
EC DRBG standard within X9, in slide 15 of his
<a href="http://csrc.nist.gov/groups/ST/crypto-review/documents/dualec_in_X982_and_sp800-90.pdf">insider
account</a>:
</p>

<i>
<ul>
<li>Doing standard in X9 made it harder to get feedback</li>
<ul>
<li>Copies not available for review except by paying</li>
<li>Few universities are X9 members, so academic cryptographers usually can&#x2019;t be involved</li>
<li>Limited number of members with the right background (e.g., RNGs)</li>
<ul>
<li>Public review not very public</li>
</ul>
</ul>
</ul>
</i>

<p>
NIST made a mistake by adopting a standard that was developed in a
manner open to manipulation. John Kelsey adds in slide 46:
</p>

<i>
<ul>
<li>Many reasons why Dual EC DRBG should not have been in standard&#x2026;</li>
<ul>
<li>Performance, Bias, Potential Trapdoor</li>
</ul>
<li>&#x2026;but it had a champion on X9.82 editing committee</li>
<ul>
<li>Common way for weak algorithms to get into standards.</li>
</ul>
</ul>
</i>

<p>
Transferring responsibility for the cryptographic module standard to
ISO would mean repeating the mistake.
</p>

<h2>Towards a solution with real benefits</h2>

<p>
That the ISO business model is not suitable for the development of
cryptographic standards does not mean that we should give up on an
international solution. An international cryptographic module
standard would be very beneficial to vendors, labs and government
agencies. Algorithms and implementation guidance should be part of
the standard and the same for all countries that accept the standard.
International cryptographic harmonization will be difficult to
achieve, but it should be a goal.
</p>

<p>
Another difficult goal to achieve will be to bring the cryptographic
module standard up to date, when we do not even have a clear concept
of what a software cryptographic module is. In his talk, Apostol
Vassilev said that NIST intends to create a working group with
representatives from government, industry, laboratories and academia.
That would be a good step towards that goal.
</p>
<strong>Share this:</strong><br><a class="synved-social-button synved-social-button-share synved-social-size-48 synved-social-resolution-single synved-social-provider-facebook nolightbox" target="_blank" rel="nofollow" title="Share on Facebook" href="http://www.facebook.com/sharer.php?u=http%3A%2F%2Fpomcor.com%2F2015%2F11%2F12%2Fcryptographic-module-standards-at-a-crossroads-after-snowdens-revelations%2F&amp;t=Cryptographic%20Module%20Standards%20at%20a%20Crossroads%20after%20Snowden%E2%80%99s%20Revelations&amp;s=100&amp;p%5Burl%5D=http%3A%2F%2Fpomcor.com%2F2015%2F11%2F12%2Fcryptographic-module-standards-at-a-crossroads-after-snowdens-revelations%2F&amp;p%5Bimages%5D%5B0%5D=&amp;p%5Btitle%5D=Cryptographic%20Module%20Standards%20at%20a%20Crossroads%20after%20Snowden%E2%80%99s%20Revelations"><img alt="facebook" title="Share on Facebook" class="synved-share-image synved-social-image synved-social-image-share" width="48" src="http://pomcor.com/wp-content/plugins/social-media-feather/synved-social/image/social/regular/96x96/facebook.png"></a><a class="synved-social-button synved-social-button-share synved-social-size-48 synved-social-resolution-single synved-social-provider-twitter nolightbox" target="_blank" rel="nofollow" title="Share on Twitter" href="http://twitter.com/share?url=http%3A%2F%2Fpomcor.com%2F2015%2F11%2F12%2Fcryptographic-module-standards-at-a-crossroads-after-snowdens-revelations%2F&amp;text=Check%20this%20out"><img alt="twitter" title="Share on Twitter" class="synved-share-image synved-social-image synved-social-image-share" width="48" src="http://pomcor.com/wp-content/plugins/social-media-feather/synved-social/image/social/regular/96x96/twitter.png"></a><a class="synved-social-button synved-social-button-share synved-social-size-48 synved-social-resolution-single synved-social-provider-google_plus nolightbox" target="_blank" rel="nofollow" title="Share on Google+" href="https://plus.google.com/share?url=http%3A%2F%2Fpomcor.com%2F2015%2F11%2F12%2Fcryptographic-module-standards-at-a-crossroads-after-snowdens-revelations%2F"><img alt="google_plus" title="Share on Google+" class="synved-share-image synved-social-image synved-social-image-share" width="48" src="http://pomcor.com/wp-content/plugins/social-media-feather/synved-social/image/social/regular/96x96/google_plus.png"></a><a class="synved-social-button synved-social-button-share synved-social-size-48 synved-social-resolution-single synved-social-provider-reddit nolightbox" target="_blank" rel="nofollow" title="Share on Reddit" href="http://www.reddit.com/submit?url=http%3A%2F%2Fpomcor.com%2F2015%2F11%2F12%2Fcryptographic-module-standards-at-a-crossroads-after-snowdens-revelations%2F&amp;title=Cryptographic%20Module%20Standards%20at%20a%20Crossroads%20after%20Snowden%E2%80%99s%20Revelations"><img alt="reddit" title="Share on Reddit" class="synved-share-image synved-social-image synved-social-image-share" width="48" src="http://pomcor.com/wp-content/plugins/social-media-feather/synved-social/image/social/regular/96x96/reddit.png"></a><a class="synved-social-button synved-social-button-share synved-social-size-48 synved-social-resolution-single synved-social-provider-linkedin nolightbox" target="_blank" rel="nofollow" title="Share on Linkedin" href="http://www.linkedin.com/shareArticle?mini=true&amp;url=http%3A%2F%2Fpomcor.com%2F2015%2F11%2F12%2Fcryptographic-module-standards-at-a-crossroads-after-snowdens-revelations%2F&amp;title=Cryptographic%20Module%20Standards%20at%20a%20Crossroads%20after%20Snowden%E2%80%99s%20Revelations"><img alt="linkedin" title="Share on Linkedin" class="synved-share-image synved-social-image synved-social-image-share" width="48" src="http://pomcor.com/wp-content/plugins/social-media-feather/synved-social/image/social/regular/96x96/linkedin.png"></a><a class="synved-social-button synved-social-button-share synved-social-size-48 synved-social-resolution-single synved-social-provider-tumblr nolightbox" target="_blank" rel="nofollow" title="Share on tumblr" href="http://tumblr.com/share?s=&amp;v=3&amp;t=Cryptographic%20Module%20Standards%20at%20a%20Crossroads%20after%20Snowden%E2%80%99s%20Revelations&amp;u=http%3A%2F%2Fpomcor.com%2F2015%2F11%2F12%2Fcryptographic-module-standards-at-a-crossroads-after-snowdens-revelations%2F"><img alt="tumblr" title="Share on tumblr" class="synved-share-image synved-social-image synved-social-image-share" width="48" src="http://pomcor.com/wp-content/plugins/social-media-feather/synved-social/image/social/regular/96x96/tumblr.png"></a><a class="synved-social-button synved-social-button-share synved-social-size-48 synved-social-resolution-single synved-social-provider-mail nolightbox" rel="nofollow" title="Share by email" href="mailto:?subject=Cryptographic%20Module%20Standards%20at%20a%20Crossroads%20after%20Snowden%E2%80%99s%20Revelations&amp;body=Check%20this%20out:%20http%3A%2F%2Fpomcor.com%2F2015%2F11%2F12%2Fcryptographic-module-standards-at-a-crossroads-after-snowdens-revelations%2F"><img alt="mail" title="Share by email" class="synved-share-image synved-social-image synved-social-image-share" width="48" src="http://pomcor.com/wp-content/plugins/social-media-feather/synved-social/image/social/regular/96x96/mail.png"></a><br>											</div>


					</div>
</body></html>
