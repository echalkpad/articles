<!DOCTYPE html><html><head><title>Develop command line application using NodeJS</title></head><body>
<h1>Develop command line application using NodeJS</h1><p><a href="https://codeforgeek.com/2015/09/command-line-application-nodejs/" target="_new">Original URL</a></p>
<p><blockquote>Node.js provides utilities to develop command line application. There are some cool application like express-geenrator and nodemo</blockquote></p>
<div><div class="td-post-content td-pb-padding-side"><div class="td-post-featured-image"><a href="https://codeforgeek.com/wp-content/uploads//2015/09/banner.jpg?07add7"><img width="640" class="entry-thumb td-modal-image" src="https://codeforgeek.com/wp-content/uploads//2015/09/banner-640x216.jpg?07add7" alt="Develop speedtest command line app using Node" title="Develop speedtest command line app using Node"></a></div><div class="td-a-rec td-a-rec-id-content_top "><a target="_blank" href="http://shareasale.com/r.cfm?b=451343&amp;u=1152768&amp;m=43811&amp;urllink=&amp;afftrack="><img src="https://i.shareasale.com/image/43811/728x902.png" border="0" alt="Learn Web Design, Coding &amp; More. No Risk. No Contracts. Learn More"></a></div><p>Node.js provides utilities to develop command line application. There are some cool application like <strong>express-geenrator</strong> and <strong><a href="http://codeforgeek.com/2014/09/update-code-without-restarting-node-server/" target="_blank">nodemon</a></strong> which runs on command line.</p><p>In this tutorial we will learn how to use command line utilities in Node and develop sample internet speed test program using <strong>speedtest.net</strong> API.</p> <figure id="attachment_1700" class="wp-caption aligncenter"><img src="https://codeforgeek.com/wp-content/uploads//2015/09/speedtest.gif?07add7" alt="speedtest command line app" width="1204" class="size-full wp-image-1700"><figcaption class="wp-caption-text">npm install speedtestcli -g</figcaption></figure><p>==&gt; Download it using <strong>npm install speedtestcli -g</strong> and test internet speed on your terminal.</p><a class="button-rounded button-flat" href="https://github.com/codeforgeek/speed-test-cli" target="_blank"><i class="fa fa-github"></i>DOWNLOAD</a><h2>Basic Hello %Your Name% Command line App.</h2><p>This example will take your name as input and gives you output right in console with greeting. Let&#x2019;s first write a code to print <strong>&#x201C;Hello World&#x201D;</strong> in code.</p><p class="file_name"><strong>cli.js</strong></p><div class="codecolorer-container javascript twitlight"><p class="javascript codecolorer">console.<span class="me1">log</span><span class="br0">(</span><span class="st0">"Hello World"</span><span class="br0">)</span><span class="sy0">;</span></p></div><p>If you save the code and run it via Node using.</p><p>You will be able to see the output in console. But this is not what we want. We want our input go like this.</p><p>And it should print</p><p>Let&#x2019;s develop this. First create <strong>package.json</strong> using <strong>npm init</strong> command OR you can copy this.</p><div class="codecolorer-container javascript twitlight"><p class="javascript codecolorer"><span class="br0">{</span><br> &#xA0; <span class="st0">"name"</span><span class="sy0">:</span> <span class="st0">"HelloWorld"</span><span class="sy0">,</span><br> &#xA0; <span class="st0">"version"</span><span class="sy0">:</span> <span class="st0">"1.0.0"</span><span class="sy0">,</span><br> &#xA0; <span class="st0">"description"</span><span class="sy0">:</span> <span class="st0">""</span><span class="sy0">,</span><br> &#xA0; <span class="st0">"author"</span><span class="sy0">:</span> <span class="st0">""</span><span class="sy0">,</span><br> &#xA0; <span class="st0">"license"</span><span class="sy0">:</span> <span class="st0">"ISC"</span><span class="sy0">,</span><br> &#xA0; <span class="st0">"bin"</span><span class="sy0">:</span> <span class="br0">{</span><br> &#xA0; &#xA0; <span class="st0">"sayHello"</span><span class="sy0">:</span> <span class="st0">"cli.js"</span><br> &#xA0; <span class="br0">}</span><span class="sy0">,</span><br> &#xA0; <span class="st0">"dependencies"</span><span class="sy0">:</span> <span class="br0">{</span><span class="br0">}</span><br> <span class="br0">}</span></p></div><p>Did you notice this line.</p><div class="codecolorer-container text twitlight"><p class="text codecolorer">&#xA0; "bin": {<br> &#xA0; &#xA0; "sayHello": "cli.js"<br> &#xA0; }</p></div><p>This line tells Node to execute particular file on this command. So its syntax is.</p><div class="codecolorer-container text twitlight"><p class="text codecolorer">"bin" : {<br> &#xA0; &#xA0;"your-command" : "file-to-execute"<br> }</p></div><p>We need to modify cli.js to following.</p><p class="file_name"><strong>cli.js</strong></p><div class="codecolorer-container javascript twitlight"><p class="javascript codecolorer">console.<span class="me1">log</span><span class="br0">(</span><span class="st0">"Hello"</span><span class="sy0">,</span>process.<span class="me1">argv</span><span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span><span class="br0">)</span><span class="sy0">;</span></p></div><p>Save the code and run it using following command.</p><p>It will print</p><p>On screen.</p><p>To make it command line you need to add following in start of the main script.</p><p>Above line tell the System that the script should be executed with the first executable named <strong>node</strong> that&#x2019;s found in your current PATH. <strong>/bin/env</strong> is standard Unix utility that looks at your current environment.<br> So final code should be like this.</p><p class="file_name"><strong>cli.js</strong></p><div class="codecolorer-container javascript twitlight"><p class="javascript codecolorer">#<span class="sy0">!/</span>usr<span class="sy0">/</span>bin<span class="sy0">/</span>env node<br> console.<span class="me1">log</span><span class="br0">(</span><span class="st0">"Hello"</span><span class="sy0">,</span>process.<span class="me1">argv</span><span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span><span class="br0">)</span><span class="sy0">;</span></p></div><p>Now run following command to install it in your system as a command line application.</p><p>This is it. Once it is installed you can access it using following command on terminal.</p><h3>Developing Speedtest command line app.</h3><p>We all know and use <strong>speedtest.net</strong> frequently to check Download and upload speed. They do provide web services too for external integration of speedtest features.</p><p>There is node module which wraps the API provided by speedtest.net ( Thanks to @ddsol for this ) called <strong>speedtest-net</strong>. We will be using that to develop our command line application.</p><p>Let&#x2019;s begin with Package.json file. Use <strong>npm init</strong> to Generate package.json for your application ( It&#x2019;s a good practice ). You may specify dependencies in the wizard or hit enter to get package.json with basic information.</p><p>You can install dependencies using.</p><div class="codecolorer-container text twitlight"><p class="text codecolorer">npm install chalk progress speedtest-net --save</p></div><p>Here is my package.json.</p><p class="file_name"><strong>package.json</strong></p><div class="codecolorer-container javascript twitlight"><p class="javascript codecolorer"><span class="br0">{</span><br> &#xA0; <span class="st0">"name"</span><span class="sy0">:</span> <span class="st0">"speedTestCLI"</span><span class="sy0">,</span><br> &#xA0; <span class="st0">"version"</span><span class="sy0">:</span> <span class="st0">"1.0.0"</span><span class="sy0">,</span><br> &#xA0; <span class="st0">"description"</span><span class="sy0">:</span> <span class="st0">""</span><span class="sy0">,</span><br> &#xA0; <span class="st0">"author"</span><span class="sy0">:</span> <span class="st0">""</span><span class="sy0">,</span><br> &#xA0; <span class="st0">"license"</span><span class="sy0">:</span> <span class="st0">"ISC"</span><span class="sy0">,</span><br> &#xA0; <span class="st0">"bin"</span><span class="sy0">:</span> <span class="br0">{</span><br> &#xA0; &#xA0; <span class="st0">"speedtest"</span><span class="sy0">:</span> <span class="st0">"index.js"</span><br> &#xA0; <span class="br0">}</span><span class="sy0">,</span><br> &#xA0; <span class="st0">"dependencies"</span><span class="sy0">:</span> <span class="br0">{</span><br> &#xA0; &#xA0; <span class="st0">"chalk"</span><span class="sy0">:</span> <span class="st0">"^1.1.1"</span><span class="sy0">,</span><br> &#xA0; &#xA0; <span class="st0">"progress"</span><span class="sy0">:</span> <span class="st0">"^1.1.8"</span><span class="sy0">,</span><br> &#xA0; &#xA0; <span class="st0">"speedtest-net"</span><span class="sy0">:</span> <span class="st0">"^1.0.3"</span><br> &#xA0; <span class="br0">}</span><br> <span class="br0">}</span></p></div><p>Install dependencies by using following command if you have not done already.</p><p>For ease, i select <strong>speedtest</strong> as command. You can change it as per your preference. Let&#x2019;s write some code for main file.</p><p class="file_name"><strong>index.js</strong></p><div class="codecolorer-container javascript twitlight"><p class="javascript codecolorer">#<span class="sy0">!/</span>usr<span class="sy0">/</span>bin<span class="sy0">/</span>env node<br> <span class="kw2">var</span> speedTest &#xA0; &#xA0;<span class="sy0">=</span> &#xA0;require<span class="br0">(</span><span class="st0">'speedtest-net'</span><span class="br0">)</span><span class="sy0">;</span><br> <span class="kw2">var</span> ProgressBar &#xA0;<span class="sy0">=</span> &#xA0;require<span class="br0">(</span><span class="st0">'progress'</span><span class="br0">)</span><span class="sy0">;</span><br> <span class="kw2">var</span> chalk &#xA0; &#xA0; &#xA0; &#xA0;<span class="sy0">=</span> &#xA0;require<span class="br0">(</span><span class="st0">"chalk"</span><span class="br0">)</span><span class="sy0">;</span><br> <br> <span class="kw2">var</span> test <span class="sy0">=</span> speedTest<span class="br0">(</span><span class="br0">{</span>maxTime<span class="sy0">:</span><span class="nu0">5000</span><span class="br0">}</span><span class="br0">)</span><span class="sy0">;</span><br> <br> <span class="kw2">var</span> bar<span class="sy0">,</span>pingTime<span class="sy0">;</span><br> <br> <span class="co1">// Event triggered when best Server is found.</span><br> <br> test.<span class="me1">on</span><span class="br0">(</span><span class="st0">'testserver'</span><span class="sy0">,</span><span class="kw2">function</span><span class="br0">(</span>server<span class="br0">)</span> <span class="br0">{</span><br> &#xA0; &#xA0; pingTime <span class="sy0">=</span> server.<span class="me1">bestPing</span><span class="sy0">;</span><br> <span class="br0">}</span><span class="br0">)</span><span class="sy0">;</span><br> <br> <span class="co1">// Invoke every time when download speed check begin</span><br> <span class="co1">// Return completion value in percentage</span><br> <br> test.<span class="me1">on</span><span class="br0">(</span><span class="st0">'downloadprogress'</span><span class="sy0">,</span><span class="kw2">function</span><span class="br0">(</span>pct<span class="br0">)</span><span class="br0">{</span><br> &#xA0; &#xA0; prog<span class="br0">(</span><span class="st0">'Checking Download Speed '</span><span class="sy0">,</span>pct<span class="br0">)</span><span class="sy0">;</span><br> <span class="br0">}</span><span class="br0">)</span><span class="sy0">;</span><br> <br> <span class="co1">// Invoke every time when upload speed check begin</span><br> <span class="co1">// Return completion value in percentage</span><br> <br> test.<span class="me1">on</span><span class="br0">(</span><span class="st0">'uploadprogress'</span><span class="sy0">,</span><span class="kw2">function</span><span class="br0">(</span>pct<span class="br0">)</span><span class="br0">{</span><br> &#xA0; &#xA0; prog<span class="br0">(</span><span class="st0">'Checking Upload Speed '</span><span class="sy0">,</span>pct<span class="br0">)</span><span class="sy0">;</span><br> <span class="br0">}</span><span class="br0">)</span><span class="sy0">;</span><br> <br> <span class="co1">// Invoke When final data recieved</span><br> <br> test.<span class="me1">on</span><span class="br0">(</span><span class="st0">'data'</span><span class="sy0">,</span><span class="kw2">function</span><span class="br0">(</span>data<span class="br0">)</span><span class="br0">{</span><br> &#xA0; &#xA0; console.<span class="me1">log</span><span class="br0">(</span>chalk.<span class="me1">cyan</span><span class="br0">(</span><span class="st0">"Ping : "</span><span class="br0">)</span><span class="sy0">,</span>Math.<span class="me1">abs</span><span class="br0">(</span>pingTime<span class="br0">)</span><span class="sy0">,</span>chalk.<span class="me1">dim</span><span class="br0">(</span><span class="st0">'ms'</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span><br> &#xA0; &#xA0; console.<span class="me1">log</span><span class="br0">(</span>chalk.<span class="me1">cyan</span><span class="br0">(</span><span class="st0">"Download Speed : "</span><span class="br0">)</span> <span class="sy0">+</span> data.<span class="me1">speeds</span>.<span class="me1">download</span> <span class="sy0">+</span> chalk.<span class="me1">dim</span><span class="br0">(</span><span class="st0">" MBps"</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span><br> &#xA0; &#xA0; console.<span class="me1">log</span><span class="br0">(</span>chalk.<span class="me1">cyan</span><span class="br0">(</span><span class="st0">"Upload Speed : "</span><span class="br0">)</span> <span class="sy0">+</span> data.<span class="me1">speeds</span>.<span class="me1">upload</span> <span class="sy0">+</span> chalk.<span class="me1">dim</span><span class="br0">(</span><span class="st0">" MBps"</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span><br> <span class="br0">}</span><span class="br0">)</span><span class="sy0">;</span><br> <br> <span class="co1">// in case of error, exit.</span><br> <br> test.<span class="me1">on</span><span class="br0">(</span><span class="st0">'error'</span><span class="sy0">,</span><span class="kw2">function</span><span class="br0">(</span>error<span class="br0">)</span><span class="br0">{</span><br> &#xA0; &#xA0; process.<span class="me1">exit</span><span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span><span class="sy0">;</span><br> <span class="br0">}</span><span class="br0">)</span><span class="sy0">;</span><br> <br> <span class="coMULTI">/*<br> &#xA0; &#xA0; function : prog<br> &#xA0; &#xA0; params : type and percentage.<br> &#xA0; &#xA0; task : update the progress bar.<br> */</span><br> <br> <span class="kw2">function</span> prog<span class="br0">(</span>what<span class="sy0">,</span>pct<span class="br0">)</span><span class="br0">{</span><br> &#xA0; &#xA0; <span class="co1">// if its completed, terminate current progress.</span><br> &#xA0; &#xA0; <span class="kw1">if</span> <span class="br0">(</span>pct<span class="sy0">&gt;=</span><span class="nu0">100</span><span class="br0">)</span><span class="br0">{</span><br> &#xA0; &#xA0; &#xA0; &#xA0; <span class="kw1">if</span> <span class="br0">(</span>bar<span class="br0">)</span> bar.<span class="me1">terminate</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span><br> &#xA0; &#xA0; &#xA0; &#xA0; bar<span class="sy0">=</span><span class="kw2">null</span><span class="sy0">;</span><br> &#xA0; &#xA0; &#xA0; &#xA0; <span class="kw1">return</span><span class="sy0">;</span><br> &#xA0; &#xA0; <span class="br0">}</span><br> &#xA0; &#xA0; <span class="co1">// if bar object is not created</span><br> &#xA0; &#xA0; <span class="kw1">if</span> <span class="br0">(</span><span class="sy0">!</span>bar<span class="br0">)</span> <span class="br0">{</span><br> &#xA0; &#xA0; &#xA0; &#xA0; <span class="kw2">var</span> green <span class="sy0">=</span> <span class="st0">'<span class="es0">\u</span>001b[42m <span class="es0">\u</span>001b[0m'</span><span class="sy0">,</span><br> &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; red <span class="sy0">=</span> <span class="st0">'<span class="es0">\u</span>001b[41m <span class="es0">\u</span>001b[0m'</span><span class="sy0">;</span><br> &#xA0; &#xA0; &#xA0; &#xA0; bar <span class="sy0">=</span> <span class="kw2">new</span> ProgressBar<span class="br0">(</span><span class="st0">' '</span><span class="sy0">+</span>what<span class="sy0">+</span><span class="st0">' [:bar] :percent'</span><span class="sy0">,</span> <span class="br0">{</span><br> &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; complete<span class="sy0">:</span> green<span class="sy0">,</span><br> &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; incomplete<span class="sy0">:</span> red<span class="sy0">,</span><br> &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; clear<span class="sy0">:</span> <span class="kw2">true</span><span class="sy0">,</span><br> &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; width<span class="sy0">:</span><span class="nu0">40</span><span class="sy0">,</span><br> &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; total<span class="sy0">:</span> <span class="nu0">100</span><br> &#xA0; &#xA0; &#xA0; &#xA0; <span class="br0">}</span><span class="br0">)</span><span class="sy0">;</span><br> &#xA0; &#xA0; <span class="br0">}</span><br> &#xA0; &#xA0; <span class="co1">// else update the bar with coming value.</span><br> &#xA0; &#xA0; bar.<span class="me1">update</span><span class="br0">(</span>pct<span class="sy0">/</span><span class="nu0">100</span><span class="br0">)</span><span class="sy0">;</span><br> <span class="br0">}</span></p></div><p>Run the program using</p><p>Install it in your system using.</p><p>And run your specified command in above case <strong>speedtest</strong> on terminal to see output.<br> <figure id="attachment_1700" class="wp-caption aligncenter"><img src="https://codeforgeek.com/wp-content/uploads//2015/09/speedtest.gif?07add7" alt="speedtest command line app" width="1204" class="size-full wp-image-1700"><figcaption class="wp-caption-text">npm install speedtestcli -g</figcaption></figure></p><h3>Conclusion:</h3><p>We learned how to develop a real-time command line application using Node.js. If you are developing framework OR working with any boilerplate generator application then command line utilities are very useful to you.</p><h3>Further reading:</h3><p><strong><a href="https://www.npmjs.com/package/commander" target="_blank">Commander</a></strong> &#x2013; NPM module designed for simple command line application solution.</p><div class="td-a-rec td-a-rec-id-content_bottom "><div id="mc_embed_signup"><p>* We hate spam a lot and there is no question that will do that ever.</p></div></div></div></div>
</body></html>
