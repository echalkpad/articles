<!DOCTYPE html><html><head><title>Meteor Meets GraphQL — KADIRA VOICE</title></head><body>
<h1>Meteor Meets GraphQL — KADIRA VOICE</h1><p><a href="https://voice.kadira.io/meteor-meets-graphql-3cba2e65fd00#.pzdd33ozl" target="_new">Original URL</a></p>
<p><blockquote>We have been using GraphQL at Kadira for about four months. Everyone at Kadira loves it. We introduced Learn GraphQL online course in October, which allows you to master the basics of GraphQL in&hellip;</blockquote></p>
<div><div class="section-inner layoutSingleColumn"><p name="6c58" id="6c58" class="graf--p graf-after--figure">We have been using <a href="http://graphql.org/" class="markup--anchor markup--p-anchor" rel="nofollow">GraphQL</a> at <a href="https://kadira.io/" class="markup--anchor markup--p-anchor" rel="nofollow">Kadira</a> for about four months. Everyone at Kadira loves it. We introduced <a href="https://learngraphql.com/" class="markup--anchor markup--p-anchor" rel="nofollow">Learn GraphQL</a> online course in October, which allows you to <a href="https://learngraphql.com/reviews" class="markup--anchor markup--p-anchor" rel="nofollow">master</a> the basics of GraphQL in under 2 hours. Now, this is our attempt to bring GraphQL to <strong class="markup--strong markup--p-strong">Meteor</strong>.</p><blockquote name="b8db" id="b8db" class="graf--pullquote pullquote graf-after--p"><strong class="markup--strong markup--pullquote-strong">This was supposed to be Kadira&#x2019;s Christmas gift to Meteor developers. Anyway, we couldn&#x2019;t deliver this on time.</strong></blockquote><blockquote name="d104" id="d104" class="graf--pullquote pullquote graf-after--pullquote"><strong class="markup--strong markup--pullquote-strong">So, this as our New Year&#x2019;s gift for 2016. Have fun!</strong></blockquote><p name="3bee" id="3bee" class="graf--p graf-after--h4">In my post on <a href="https://kadira.io/blog/meteor/why-meteor-needs-a-new-data-layer" class="markup--anchor markup--p-anchor" rel="nofollow"><strong class="markup--strong markup--p-strong">Why Meteor needs a new data layer</strong></a>, I pointed out why we need to think about Meteor&#x2019;s data stack again. MongoDB is <strong class="markup--strong markup--p-strong">good</strong> enough to get started. But when we are scaling our app, we need to integrate with <strong class="markup--strong markup--p-strong">different kinds of databases</strong> and other data sources.</p><p name="973f" id="973f" class="graf--p graf-after--p">That&#x2019;s where GraphQL is going to help us. It&#x2019;s an <a href="https://learngraphql.com/basics/introduction" class="markup--anchor markup--p-anchor" rel="nofollow">application-layer query language</a> that is independent of any database or backend. So, we can easily integrate it with <strong class="markup--strong markup--p-strong">any database</strong> we like.</p><p name="65aa" id="65aa" class="graf--p graf-after--p">Additionally in the client, we can define data requirement for our UIs declaratively. That&#x2019;s pretty useful when building large applications.</p><blockquote name="54a9" id="54a9" class="graf--blockquote graf-after--p">If you are new to GraphQL, look at the <a href="https://learngraphql.com/basics/introduction" class="markup--anchor markup--blockquote-anchor" rel="nofollow">first six lessons</a> of our Learn GraphQL course.</blockquote><p name="a7ed" id="a7ed" class="graf--p graf-after--h4">Before we look at the GraphQL Meteor integration, check out this demo app. It&#x2019;s a simple blog app that uses GraphQL as the data layer. It has all the essential features of a modern JavaScript app:</p><ul class="postList"><li name="2a0e" id="2a0e" class="graf--li graf-after--p">Querying in client</li><li name="b9d1" id="b9d1" class="graf--li graf-after--li">Client-side caching</li><li name="7e8f" id="7e8f" class="graf--li graf-after--li">Mutations</li><li name="f158" id="f158" class="graf--li graf-after--li">Optimistic updates</li><li name="fbb0" id="fbb0" class="graf--li graf-after--li">Authorization</li></ul><p name="1438" id="1438" class="graf--p graf-after--li">See it live at <a href="http://graphql-blog.meteor.com/" class="markup--anchor markup--p-anchor" rel="nofollow">http://graphql-blog.meteor.com</a> or watch <a href="https://www.youtube.com/watch?v=rTgk7cDbRG0" class="markup--anchor markup--p-anchor" rel="nofollow">this</a> video:</p><figure name="ed41" id="ed41" class="graf--figure graf--iframe graf-after--p"></figure><blockquote name="0263" id="0263" class="graf--blockquote graf-after--figure">Here&#x2019;s the <a href="https://github.com/kadira-samples/meteor-graphql-demo" class="markup--anchor markup--blockquote-anchor" rel="nofollow">source code</a> of the app.</blockquote><p name="45f3" id="45f3" class="graf--p graf-after--h3">Meteor is all about the developer experience. GraphQL also comes with a great developer experience with it&#x2019;s <strong class="markup--strong markup--p-strong">declarative data fetching</strong> and it&#x2019;s in-browser IDE, <a href="https://github.com/graphql/graphiql" class="markup--anchor markup--p-anchor" rel="nofollow">GraphiQL</a>. We wanted to bring both of these experiences together.</p><p name="9fd6" id="9fd6" class="graf--p graf-after--h4">Add the <a href="https://github.com/kadirahq/meteor-graphql" class="markup--anchor markup--p-anchor" rel="nofollow"><strong class="markup--strong markup--p-strong">kadira:graphql</strong></a> package into your app with:</p><pre name="1ef0" id="1ef0" class="graf--pre graf-after--p">meteor add kadira:graphql</pre><p name="d561" id="d561" class="graf--p graf-after--pre">Then start your app and visit <a href="http://localhost:3000/graphql" class="markup--anchor markup--p-anchor">http://localhost:3000/graphql</a> to see your GraphQL schemas (We assume your app runs in port 3000).</p><figure name="1f86" id="1f86" class="graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked"><img class="graf-image" src="https://d262ilb51hltx0.cloudfront.net/max/800/1*ACeeR_WMgLg1LiUhsWs3vg.png"></div></figure><blockquote name="5d12" id="5d12" class="graf--blockquote graf-after--figure">This page is available in the development version of your app only.</blockquote><p name="8d84" id="8d84" class="graf--p graf-after--h4">We&#x2019;ve a default schema called <strong class="markup--strong markup--p-strong">SysInfo</strong>, which exposes some system information to your app. You can play with the schema by opening the in-browser GraphQL IDE.</p><blockquote name="0345" id="0345" class="graf--blockquote graf-after--p">Simply click on the schema name of the above page: <a href="http://localhost:3000/graphql" class="markup--anchor markup--blockquote-anchor">http://localhost:3000/graphql</a>.</blockquote><p name="fdb0" id="fdb0" class="graf--p graf-after--blockquote">In that, try querying the following schema:</p><figure name="854b" id="854b" class="graf--figure graf--iframe graf-after--p"></figure><figure name="30e4" id="30e4" class="graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked"><img class="graf-image" src="https://d262ilb51hltx0.cloudfront.net/max/800/1*ZiXcwJmjOU3DBrT7Sn2hGQ.gif"></div></figure><p name="4377" id="4377" class="graf--p graf-after--figure">If you create a GraphQL schema then you can simply register it with Meteor with the API <a href="https://github.com/kadirahq/meteor-graphql/#graphqlregisterschema-server-only" class="markup--anchor markup--p-anchor" rel="nofollow"><strong class="markup--strong markup--p-strong">GraphQL.registerSchema()</strong></a> on the server. Then you can access it via the above IDE and inside the client.</p><p name="d9a4" id="d9a4" class="graf--p graf-after--p"><a href="https://github.com/kadira-samples/meteor-graphql-demo/blob/e17d8ed5907ea9790ee7e421cfe13ae3b40bd13e/server/schema.js#L90" class="markup--anchor markup--p-anchor" rel="nofollow">Click here</a> on how to do it.</p><p name="5648" id="5648" class="graf--p graf-after--h4">For the client-side data fetching, we are going to use <a href="https://github.com/kadirahq/lokka" class="markup--anchor markup--p-anchor" rel="nofollow">Lokka</a>. It&#x2019;s a GraphQL client that works everywhere (inside the client, the server and React Native). Lokka is already bundled with <strong class="markup--strong markup--p-strong">kadira:graphql</strong>.</p><p name="1658" id="1658" class="graf--p graf-after--p">Now we are going to display our app&#x2019;s system information in the UI. For that, we are going to use <strong class="markup--strong markup--p-strong">React</strong>. So add React to your app with:</p><pre name="33c5" id="33c5" class="graf--pre graf-after--p">meteor add react</pre><p name="b46a" id="b46a" class="graf--p graf-after--pre">Then create a file called <strong class="markup--strong markup--p-strong">client/app.jsx</strong> and let&#x2019;s start writing our app.</p><blockquote name="87b1" id="87b1" class="graf--blockquote graf-after--p">First, we need to create a Lokka client that is linked with our SysInfo schema:</blockquote><pre name="5c59" id="5c59" class="graf--pre graf-after--blockquote">SysInfoSchema = GraphQL.createLokkaClient('SysInfo');</pre><blockquote name="19e7" id="19e7" class="graf--blockquote graf-after--pre">Then we need to create a simple React component to display the system information:</blockquote><figure name="0025" id="0025" class="graf--figure graf--iframe graf-after--blockquote"></figure><p name="79b6" id="79b6" class="graf--p graf-after--figure">Here we use React&#x2019;s <a href="https://medium.com/@joshblack/stateless-components-in-react-0-14-f9798f8b992d#.w4enkzapw" class="markup--anchor markup--p-anchor">stateless components</a>, which come with React 0.14.3.</p><blockquote name="e625" id="e625" class="graf--blockquote graf-after--p">Then let&#x2019;s define our data requirements for the above component:</blockquote><figure name="2c37" id="2c37" class="graf--figure graf--iframe graf-after--blockquote"></figure><p name="2299" id="2299" class="graf--p graf-after--figure">Here we create a <a href="https://learngraphql.com/basics/fragments" class="markup--anchor markup--p-anchor" rel="nofollow">GraphQL fragment</a> on type SysInfo in our schema.</p><blockquote name="444e" id="444e" class="graf--blockquote graf-after--p">Now it&#x2019;s time to bind the query with the above component:</blockquote><figure name="ea53" id="ea53" class="graf--figure graf--iframe graf-after--blockquote"></figure><p name="f73b" id="f73b" class="graf--p graf-after--figure">Here we define a GraphQL query with a fragment to fetch data. This is very similar to what we&#x2019;ve done in the in-browser IDE.</p><p name="4b9d" id="4b9d" class="graf--p graf-after--p">Then we use a React utility called <a href="https://github.com/kadirahq/meteor-graphql/#graphqlbinddata-client-only" class="markup--anchor markup--p-anchor" rel="nofollow"><strong class="markup--strong markup--p-strong">GraphQL.bindData()</strong></a>, which watches for changes in a query and re-renders the component with the data. It&#x2019;s <strong class="markup--strong markup--p-strong">not related</strong> to GraphQL in any way. It&#x2019;s a general purpose React utility for binding data to a component.</p><p name="68f2" id="68f2" class="graf--p graf-after--h4">Now let&#x2019;s render our <strong class="markup--strong markup--p-strong">SysInfoContainer</strong> to the UI. For that, do this:</p><figure name="9459" id="9459" class="graf--figure graf--iframe graf-after--p"></figure><p name="0e58" id="0e58" class="graf--p graf-after--h4">It&#x2019;s good if we can see the latest system information. For that, we can do something like this:</p><figure name="4051" id="4051" class="graf--figure graf--iframe graf-after--p"></figure><p name="e009" id="e009" class="graf--p graf-after--figure">Now, every 2 seconds, we&#x2019;ll ask Lokka to refetch the query. Then it&#x2019;ll update the cache and eventually, the UI will be updated.</p><figure name="df0c" id="df0c" class="graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked"><img class="graf-image" src="https://d262ilb51hltx0.cloudfront.net/max/800/1*7qEk7yzjC8pfxfGfzHC8cQ.gif"></div></figure><p name="a951" id="a951" class="graf--p graf-after--figure">Checkout <a href="https://github.com/kadira-samples/hello-graphql-meteor" class="markup--anchor markup--p-anchor" rel="nofollow">this repo</a> for the complete app.</p><p name="1803" id="1803" class="graf--p graf-after--h3">This is just a simple use of GraphQL. You can use GraphQL to build a real app with authentication and other features. For that, refer to the following links:</p><ul class="postList"><li name="6087" id="6087" class="graf--li graf-after--p"><a href="https://learngraphql.com/" class="markup--anchor markup--li-anchor" rel="nofollow">Learn GraphQL</a></li><li name="9044" id="9044" class="graf--li graf-after--li"><a href="https://github.com/kadira-samples/meteor-graphql-demo" class="markup--anchor markup--li-anchor" rel="nofollow">Simple Blog App </a>written with Meteor &amp; GraphQL</li><li name="56a3" id="56a3" class="graf--li graf-after--li"><a href="https://github.com/kadirahq/meteor-graphql" class="markup--anchor markup--li-anchor" rel="nofollow">Meteor GraphQL integration</a></li><li name="41c7" id="41c7" class="graf--li graf-after--li"><a href="https://github.com/kadirahq/lokka" class="markup--anchor markup--li-anchor" rel="nofollow">Lokka API</a></li></ul><p name="c9be" id="c9be" class="graf--p graf-after--h3">This is just the start. We are going to develop GraphQL support for Meteor in <strong class="markup--strong markup--p-strong">two</strong> ways.</p><p name="1f7d" id="1f7d" class="graf--p graf-after--h4">On the server side, we'll have easy ways to define new schemas. But most of them will be <strong class="markup--strong markup--p-strong">NPM packages</strong>. We'll also work on support for <strong class="markup--strong markup--p-strong">real-time </strong>GraphQL. That'll have some Meteor-specific stuff.</p><p name="c06d" id="c06d" class="graf--p graf-after--p">Real-time support will be based on <strong class="markup--strong markup--p-strong">application-specific events</strong>. So, we could plug in any database with a queue like Kafka (or even Redis) to make our apps real-time.</p><blockquote name="857f" id="857f" class="graf--blockquote graf-after--p">This is the how we scale non-Meteor apps. We may need to do a bit more than how we handle real-time behavior in Meteor. But, it's totally worthwhile in the long run.</blockquote><p name="2297" id="2297" class="graf--p graf-after--h4">The client-side version of GraphQL won't be Meteor specific at all. Most of the development will be improvements to <a href="https://github.com/kadirahq/lokka" class="markup--anchor markup--p-anchor" rel="nofollow">Lokka</a>. We'll also invest in some tools specific to React and Tracker.</p><p name="f53a" id="f53a" class="graf--p graf-after--p">You can even use <a href="https://facebook.github.io/relay/" class="markup--anchor markup--p-anchor" rel="nofollow">Facebook's Relay</a> for much deeper React integration.</p><p name="b8dc" id="b8dc" class="graf--p graf-after--h3">We always had ways to integrate Meteor with different databases. That&#x2019;s with custom publications and Meteor methods.</p><p name="4910" id="4910" class="graf--p graf-after--p">With GraphQL, we&#x2019;ve a proper way to do this. We can reuse schemas available in NPM or even use schemas written in other languages. This will <strong class="markup--strong markup--p-strong">redefine</strong> microservices as <strong class="markup--strong markup--p-strong">micro-schemas</strong>. I&#x2019;ll talk more them about in a different post.</p><p name="f85e" id="f85e" class="graf--p graf-after--p">Imagine a situation like this:</p><ul class="postList"><li name="f4b9" id="f4b9" class="graf--li graf-after--p">Backend developers write GraphQL schemas and types for different use-cases (blogs and chat apps). Anyone can get them via NPM.</li><li name="bec9" id="bec9" class="graf--li graf-after--li">We can even access third-party APIs via GraphQL. We could use them inside our apps, just like above schemas.</li><li name="80e7" id="80e7" class="graf--li graf-after--li">Client-side developers can build great user interfaces for GraphQL schemas. They&#x2019;ll also be available via NPM.</li></ul><blockquote name="cfd0" id="cfd0" class="graf--pullquote pullquote graf-after--li">This will lead to better products, increased productivity and more collaboration.</blockquote><p name="683c" id="683c" class="graf--p graf-after--pullquote graf--last">The best thing is, this is not the future. <strong class="markup--strong markup--p-strong">It&#x2019;s already started.</strong> That&#x2019;s why we need to focus more on <strong class="markup--strong markup--p-strong">GraphQL</strong>.</p></div></div>
</body></html>
