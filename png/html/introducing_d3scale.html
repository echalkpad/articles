<!DOCTYPE html><html><head><title>Introducing d3-scale</title></head><body>
<h1>Introducing d3-scale</h1><p><a href="https://medium.com/@mbostock/introducing-d3-scale-61980c51545f#.ksp3lylvr" target="_new">Original URL</a></p>
<p><blockquote>I’d like D3 to become the standard library of data visualization: not just a tool you use directly to visualize data by writing code, but also a suite of tools that underpin more powerful software.To&hellip;</blockquote></p>
<section name="e70a" class=" section--body section--first section--last" score="41.25"><div class="section-content" score="52.5"><div class="section-inner layoutSingleColumn" score="-6.25"><p name="7dfa" id="7dfa" class="graf--p graf-after--h3">I’d like D3 to become the standard library of data visualization: not just a tool you use directly to visualize data by writing code, but also a suite of tools that underpin more powerful software.</p><p name="ccf6" id="ccf6" class="graf--p graf-after--p">To this end, D3 espouses abstractions that are useful for any visualization application and rejects the tyranny of charts.</p><figure name="3768" id="3768" class="graf--figure graf-after--p" score="-12.5"><div class="aspectRatioPlaceholder is-locked" score="6.25"><img class="graf-image" src="https://cdn-images-1.medium.com/max/800/1*lgRTO__UEihFlgbeKRz5ng.png"></div></figure><p name="c608" id="c608" class="graf--p graf-after--figure">As Leland Wilkinson wrote in <a href="https://books.google.com/books?id=_kRX4LoFfGQC" class="markup--anchor markup--p-anchor" rel="nofollow"><em class="markup--em markup--p-em">The Grammar of Graphics</em></a>,</p><blockquote name="54e6" id="54e6" class="graf--blockquote graf-after--p">If we endeavor to develop a charting instead of a graphing program, we will accomplish two things. First, we inevitably will offer fewer charts than people want. Second, our package will have no deep structure. Our computer program will be unnecessarily complex, because we will fail to reuse objects or routines that function similarly in different charts. And we will have no way to add new charts to our system without generating complex new code. Elegant design requires us to think about a theory of graphics, not charts.</blockquote><p name="4f37" id="4f37" class="graf--p graf-after--blockquote">If visualization is constructing “visual representations of abstract data to <a href="https://books.google.com/books?id=wdh2gqWfQmgC" class="markup--anchor markup--p-anchor" rel="nofollow">amplify cognition</a>”, then perhaps the most important concept in D3 is the <em class="markup--em markup--p-em">scale</em>, which maps a dimension of abstract data to a visual variable.</p><p name="544f" id="544f" class="graf--p graf-after--p">And now scales are available in a standalone library, <a href="https://github.com/d3/d3-scale" class="markup--anchor markup--p-anchor" rel="nofollow">d3-scale</a>.</p><p name="b83f" id="b83f" class="graf--p graf-after--p">But what is a “dimension” of data? Or a “visual variable”? Consider a table of data, as in a spreadsheet. Each row in the table is a vector, and each column is a dimension. A dimension is just a named attribute whose values have a particular meaning, such as a price in dollars.</p><figure name="a9d2" id="a9d2" class="graf--figure graf-after--p" score="-12.5"><div class="aspectRatioPlaceholder is-locked" score="6.25"><img class="graf-image" src="https://cdn-images-1.medium.com/max/800/1*V6UFFEUmE6Hv7wv5TqU-Bg.png"></div></figure><p name="c433" id="c433" class="graf--p graf-after--figure">We typically think of dimensions as spatial and quantitative, such as a position in space represented by real numbers ⟨<em class="markup--em markup--p-em">x, y, z</em>⟩. Yet with abstract data there are also non-quantitative dimensions; for example, diamond cut quality (fair, good, very good, ideal) is ordinal, while diamond cut shape (princess, round, marquise, <em class="markup--em markup--p-em">etc.</em>) is categorical.</p><p name="fee3" id="fee3" class="graf--p graf-after--p">Visual variables are best explained by Jacques Bertin in <a href="http://esripress.esri.com/display/index.cfm?fuseaction=display&amp;websiteID=190" class="markup--anchor markup--p-anchor" rel="nofollow"><em class="markup--em markup--p-em">Semiology of Graphics</em></a><em class="markup--em markup--p-em">.</em> He described how graphical marks (say, dots in a scatterplot) can represent data using planar position ⟨<em class="markup--em markup--p-em">x, y</em>⟩ and a luminous dimension <em class="markup--em markup--p-em">z</em>:</p><blockquote name="a042" id="a042" class="graf--blockquote graf-after--p">Within the plane a mark can be at the top or the bottom, to the right or the left. The eye perceives two independent dimensions along X and Y, which are distinguished orthogonally. A variation in light energy<strong class="markup--strong markup--blockquote-strong"> </strong>produces a third dimension in Z, which is independent of X and Y…</blockquote><blockquote name="161f" id="161f" class="graf--blockquote graf-after--blockquote">The eye is sensitive, along the Z dimension, to 6 independent visual variables, which can be superimposed on the planar figures: the size of the marks, their value, texture, color, orientation, and shape. They can represent differences (≠), similarities (≡), a quantified order (Q), or a nonquantified order (O), and can express groups, hierarchies, or vertical movements.</blockquote><figure name="2cb5" id="2cb5" class="graf--figure graf-after--blockquote" score="-12.5"><div class="aspectRatioPlaceholder is-locked" score="6.25"><img class="graf-image" src="https://cdn-images-1.medium.com/max/800/1*jsb78Rr2cDy6zrE7j2IKig.png"></div><figcaption class="imageCaption">From <a href="http://esripress.esri.com/display/index.cfm?fuseaction=display&amp;websiteID=190" class="markup--anchor markup--figure-anchor" rel="nofollow"><em class="markup--em markup--figure-em">Semiology of Graphics</em></a>, colorized by the author.</figcaption></figure><p name="0ce2" id="0ce2" class="graf--p graf-after--figure">Thus, a scale is a function that takes an <em class="markup--em markup--p-em">abstract value</em> of data, such as the mass of a diamond in carats, and returns a <em class="markup--em markup--p-em">visual value</em> such as the horizontal position of a dot in pixels. With two scales (one each for <em class="markup--em markup--p-em">x</em> and <em class="markup--em markup--p-em">y</em>), we have the basis for a scatterplot.</p></div><div class="section-inner sectionLayout--outsetColumn" score="1.25"><figure name="1a8c" id="1a8c" class="graf--figure graf--layoutOutsetCenter graf-after--p" score="-12.5"><div class="aspectRatioPlaceholder is-locked" score="6.25"><img class="graf-image" src="https://cdn-images-1.medium.com/max/1200/1*DwPi4qo-Jf01Y0jdRuZrEg.png"></div><figcaption class="imageCaption">The relationship between diamond mass <em class="markup--em markup--figure-em">and</em> price. <a href="http://bl.ocks.org/mbostock/ebb45892cc6ec5e6c902" class="markup--anchor markup--figure-anchor" rel="nofollow">View source.</a></figcaption></figure></div><div class="section-inner layoutSingleColumn"><p name="08a0" id="08a0" class="graf--p graf-after--figure">To illustrate how scales work, imagine how you might compute <em class="markup--em markup--p-em">x</em> and <em class="markup--em markup--p-em">y</em> for each dot above. Given some values derived from data (minCarat, maxCarat, minPrice, maxPrice) and some from the chart size (width, height), you might do something like this:</p><pre name="0402" id="0402" class="graf--pre graf-after--p">function x(carat) {<br> return (carat - minCarat)<br> / (maxCarat - minCarat)<br> articles _articles bin CAs devops Documents dotfiles gethtml go hnews jason js netdata start-thesrc thesrc ucii width;<br>}</pre><pre name="a3d9" id="a3d9" class="graf--pre graf-after--pre">function y(price) {<br> return height<br> - (price - minPrice)<br> / (maxPrice - minPrice)<br> articles _articles bin CAs devops Documents dotfiles gethtml go hnews jason js netdata start-thesrc thesrc ucii height;<br>}</pre><p name="fd1a" id="fd1a" class="graf--p graf-after--pre">The lightest diamond is placed at the chart’s left edge, the heaviest diamond is placed at the chart’s right edge, and so on. Note that the range of the <em class="markup--em markup--p-em">y</em>-scale is inverted because graphics systems put the origin in the top-left corner whereas scatterplots put it in the bottom-left.</p><p name="b4fd" id="b4fd" class="graf--p graf-after--p">Like the above, D3’s quantitative scales are functions configured by two intervals. The input <em class="markup--em markup--p-em">domain</em> is an interval in the abstract dimension of data, often the <a href="https://github.com/d3/d3-array#extent" class="markup--anchor markup--p-anchor" rel="nofollow">extent</a> of the observed values. The output <em class="markup--em markup--p-em">range</em> is an interval in the visual variable, such as the visible area defined by the chart size.</p><pre name="492b" id="492b" class="graf--pre graf-after--p">var x = d3_scale.linear()<br> .domain(d3_array.extent(data, function(d) { return d.carat; }))<br> .range([0, width]);</pre><pre name="a16c" id="a16c" class="graf--pre graf-after--pre">var y = d3_scale.linear()<br> .domain(d3_array.extent(data, function(d) { return d.price; }))<br> .range([height, 0]);</pre><p name="57c7" id="57c7" class="graf--p graf-after--pre">But scales do much more than basic arithmetic!</p><p name="0f75" id="0f75" class="graf--p graf-after--p">For one, it is now trivial to apply quantitative transformations: replace a <a href="https://github.com/d3/d3-scale#linear" class="markup--anchor markup--p-anchor" rel="nofollow">linear</a> scale with a <a href="https://github.com/d3/d3-scale#log-scales" class="markup--anchor markup--p-anchor" rel="nofollow">logarithmic</a> or <a href="https://github.com/d3/d3-scale#power-scales" class="markup--anchor markup--p-anchor" rel="nofollow">power</a> scale. A linear scale is a good default choice because it preserves proportionality, but a log or pow scale may aid the differentiation of data that is not uniformly distributed. (Log scales are also good for <a href="http://bl.ocks.org/mbostock/c69f5960c6b1a95b6f78" class="markup--anchor markup--p-anchor" rel="nofollow">showing change</a>.)</p></div><div class="section-inner sectionLayout--outsetColumn" score="1.25"><figure name="9608" id="9608" class="graf--figure graf--layoutOutsetCenter graf-after--p" score="-12.5"><div class="aspectRatioPlaceholder is-locked" score="6.25"><img class="graf-image" src="https://cdn-images-1.medium.com/max/1200/1*_IYHXdjCloGggu03_OCpcw.png"></div><figcaption class="imageCaption">The previous scatterplot modified to use log scales. <a href="http://bl.ocks.org/mbostock/c3034eef9d73b5fdf274" class="markup--anchor markup--figure-anchor" rel="nofollow">View source.</a></figcaption></figure></div><div class="section-inner layoutSingleColumn" score="-2.5"><p name="5cc0" id="5cc0" class="graf--p graf-after--figure">For two, scales alleviate the tedium of drawing legible axes by <a href="https://github.com/d3/d3-scale#continuous_ticks" class="markup--anchor markup--p-anchor" rel="nofollow">generating</a> and <a href="https://github.com/d3/d3-scale#continuous_tickFormat" class="markup--anchor markup--p-anchor" rel="nofollow">formatting</a> nice, round values (<em class="markup--em markup--p-em">ticks</em>) from the domain. A scale’s ticks are type-appropriate: for example, the log ticks above are uniformly-spaced within each power of ten, while a time scale uses calendar intervals.</p><p name="05c5" id="05c5" class="graf--p graf-after--p">Most scales are bidirectional<em class="markup--em markup--p-em">: </em>you can <a href="https://github.com/d3/d3-scale#continuous_invert" class="markup--anchor markup--p-anchor" rel="nofollow">invert</a> the mapping from visual representation back to abstract data, facilitating interaction. For example, a brushed interval in pixels can be inverted to abstract data for querying.</p><figure name="a7e9" id="a7e9" class="graf--figure graf-after--p" score="-12.5"><div class="aspectRatioPlaceholder is-locked" score="6.25"><img class="graf-image" src="https://cdn-images-1.medium.com/max/800/1*5V0nv0k69NyNcVtSjAiyqA.gif"></div><figcaption class="imageCaption">Brushing a scatterplot matrix. <a href="http://bl.ocks.org/mbostock/4063663" class="markup--anchor markup--figure-anchor" rel="nofollow">View source.</a></figcaption></figure><p name="fdcd" id="fdcd" class="graf--p graf-after--figure">And there are scales for ordinal and categorical data. The <a href="https://github.com/d3/d3-scale#band-scales" class="markup--anchor markup--p-anchor" rel="nofollow">band</a> scale, for instance, simplifies the calculation of bar widths and positions, allowing configurable padding, alignment and rounding.</p><figure name="f001" id="f001" class="graf--figure graf-after--p" score="-12.5"><div class="aspectRatioPlaceholder is-locked" score="6.25"><img class="graf-image" src="https://cdn-images-1.medium.com/max/800/1*cIYJvJvpPlsC0i1eD69nqw.png"></div><figcaption class="imageCaption">The frequency of English letters. <a href="http://bl.ocks.org/mbostock/946ddf8a32b3b660ffd8" class="markup--anchor markup--figure-anchor" rel="nofollow">View source.</a></figcaption></figure><p name="431f" id="431f" class="graf--p graf-after--figure">Yet scales are not just for positioning; they are for computing <em class="markup--em markup--p-em">any</em> visual variable. Scales can <a href="https://github.com/d3/d3-scale#continuous_interpolate" class="markup--anchor markup--p-anchor" rel="nofollow">interpolate</a> symbol sizes, font sizes, stroke widths, colors in various color spaces, geometric transforms, shapes and even deeply-nested objects. Below, a scale represents quantity using angular orientation, with small numbers leaning left (\) and large numbers leaning right (/). This reveals the behavior of a sorting algorithm on an array of numbers:</p></div><div class="section-inner sectionLayout--outsetColumn" score="1.25"><figure name="0df2" id="0df2" class="graf--figure graf--layoutOutsetCenter graf-after--p" score="-12.5"><div class="aspectRatioPlaceholder is-locked" score="6.25"><img class="graf-image" src="https://cdn-images-1.medium.com/max/1200/1*IUn5Qb-VneCovMfH8PqAsA.png"></div><figcaption class="imageCaption">Visualizing quicksort. From <a href="http://bost.ocks.org/mike/algorithms/" class="markup--anchor markup--figure-anchor" rel="nofollow">Visualizing Algorithms.</a></figcaption></figure></div><div class="section-inner layoutSingleColumn"><p name="8fa8" id="8fa8" class="graf--p graf-after--figure">Below, a square-root scale computes the appropriate radius so that the area of each county’s bubble is proportional to the number of people living there:</p></div><div class="section-inner sectionLayout--outsetColumn" score="1.25"><figure name="eece" id="eece" class="graf--figure graf--layoutOutsetCenter graf-after--p" score="-12.5"><div class="aspectRatioPlaceholder is-locked" score="6.25"><img class="graf-image" src="https://cdn-images-1.medium.com/max/1200/1*K1xOjX_qc_6TtP7hU_o5hA.png"></div><figcaption class="imageCaption">Population in 2008. From <a href="http://bost.ocks.org/mike/bubble-map/" class="markup--anchor markup--figure-anchor" rel="nofollow">Let’s Make a Bubble Map</a>.</figcaption></figure></div><div class="section-inner layoutSingleColumn"><p name="8c61" id="8c61" class="graf--p graf-after--figure">Below, a comparison of perceptually-uniform sequential color scales used for a choropleth of unemployment rate:</p></div><div class="section-inner sectionLayout--outsetRow" score="-6.25"><figure name="5c0e" id="5c0e" class="graf--figure graf--layoutOutsetRow is-partialWidth graf-after--p" score="-12.5"><div class="aspectRatioPlaceholder is-locked" score="6.25"><img class="graf-image" src="https://cdn-images-1.medium.com/max/400/1*0ptljP-upBOkJG0_8o05zg.png"></div></figure><figure name="9450" id="9450" class="graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" score="-12.5"><div class="aspectRatioPlaceholder is-locked" score="6.25"><img class="graf-image" src="https://cdn-images-1.medium.com/max/400/1*bG7dyONArCRSUSJFgFFehA.png"></div></figure><figure name="b3b3" id="b3b3" class="graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" score="-12.5"><div class="aspectRatioPlaceholder is-locked" score="6.25"><img class="graf-image" src="https://cdn-images-1.medium.com/max/400/1*MAOWJ7_NI5yVrYDUzcRJug.png"></div><figcaption class="imageCaption">Unemployment in 2008, using magma, viridis and cubehelix. Darker colors indicate a higher unemployment rate. <a href="http://bl.ocks.org/mbostock/4060606" class="markup--anchor markup--figure-anchor" rel="nofollow">View source.</a></figcaption></figure></div><div class="section-inner layoutSingleColumn"><p name="b841" id="b841" class="graf--p graf-after--figure">You can even create piecewise scales for diverging colors, or quantize scales for applying discrete breaks to continuous data.</p><p name="1580" id="1580" class="graf--p graf-after--p">So, <a href="https://github.com/d3/d3-scale" class="markup--anchor markup--p-anchor" rel="nofollow">try it out</a>! And check out the other <a href="https://github.com/d3" class="markup--anchor markup--p-anchor" rel="nofollow">new D3 modules</a>, too, such as <a href="https://github.com/d3/d3-time" class="markup--anchor markup--p-anchor" rel="nofollow">d3-time</a>, <a href="https://github.com/d3/d3-format" class="markup--anchor markup--p-anchor" rel="nofollow">d3-format</a>, and <a href="https://medium.com/@mbostock/introducing-d3-shape-73f8367e6d12" class="markup--anchor markup--p-anchor">d3-shape</a>.</p><p name="e0d7" id="e0d7" class="graf--p graf-after--p">Happy scaling!</p></div></div></section>
</body></html>
