<!DOCTYPE html><html><head><title>Install Spotweb on Raspberry Pi for Personal Usenet Indexer</title></head><body>
<h1>Install Spotweb on Raspberry Pi for Personal Usenet Indexer</h1><p><a href="http://www.htpcguides.com/install-spotweb-on-raspberry-pi-for-personal-usenet-indexer/" target="_new">Original URL</a></p>
<p><blockquote>Spotweb is a usenet indexing software very popular in the Netherlands. Spotweb has a simple interface for displaying&#xA0;the latest spots and associated nzbs. The Spotweb framework provides a&hellip;</blockquote></p>
<div><div class="entry-content"><p><img class=" size-full wp-image-5911 alignleft" src="" alt="spotweb-logo" width="216"></p><a href="https://github.com/spotweb/spotweb" target="_blank" class="external" rel="nofollow">Spotweb</a> is a usenet indexing software very popular in the Netherlands. Spotweb has a simple interface for displaying&#xA0;the latest spots and associated nzbs. The Spotweb framework provides a newznab compatible API that can be used as a personal indexer with automation software like Sonarr, SickRage, CouchPotato, Headphones, Mylar, LazyLibrarian and more. The Raspberry&#xA0;Pi works as a Spotweb personal usenet indexer surprisingly&#xA0;well updating spots every hour.&#xA0;This guide&#xA0;was tested on a Raspberry Pi 2 but should work on earlier versions as well like the Raspberry Pi B+ and A models.<p>Spotweb requires several components to function</p><ul><li>MySQL database for storing the category of spots and nzbs</li><li>PHP for processing headers and displaying the Spotweb web interface</li></ul><h3>Install MySQL</h3><p>Update your Raspberry Pi repositories</p><pre><code>sudo apt-get update</code></pre><p>Install MySQL&#xA0;to store&#xA0;Spots and nzb information on the Raspberry Pi</p><pre><code>sudo apt-get install mysql-server -y</code></pre><p>Enter your MySQL as the root user to create the spotweb user and database</p><pre><code>mysql -u root -p</code></pre><p>Create a MySQL user for spotwebuser, create the database called spotwebdb and grant privileges to the spotwebuser.</p><pre><code>CREATE USER <span>spotwebuser</span>@localhost IDENTIFIED BY '<span>password</span>';
CREATE DATABASE <span>spotwebdb</span>;
GRANT ALL PRIVILEGES ON <span>spotwebdb</span>.* TO <span>spotwebuser</span>@localhost IDENTIFIED BY '<span>password</span>';
FLUSH PRIVILEGES;
exit</code></pre><h3>Install PHP</h3><p>Install PHP or&#xA0;Spotweb won&#x2019;t run</p><pre><code>sudo apt-get install php5-mysql php5-curl php5-gd php5-cli -y</code></pre><p>Change your timezone for php</p><pre><code>sudo nano /etc/php5/fpm/php.ini</code></pre><p>Uncomment ;date.timezone= by deleting the semicolon, a list of timezones can be found <a href="http://php.net/manual/en/timezones.php" target="_blank" class="external" rel="nofollow">here</a></p><pre><code>date.timezone = Europe/Copenhagen</code></pre><p>You can adjnust the amount of memory php can use&#xA0;though I have found that Spotweb indexing is more CPU intensive than anything else.</p><pre><code>memory_limit = 512M</code></pre><p>Ctrl+X, Y and Enter to Save</p><p>Make the same changes in the command line php.ini since this is what is used for grabbing new headers</p><pre><code>sudo nano /etc/php5/cli/php.ini</code></pre><h3>Install nginx</h3><p>Install nginx and php5-fpm for serving PHP, SSL is included in case you want to use https</p><pre><code>sudo apt-get install nginx openssl php5-fpm -y</code></pre><p>Create the Spotweb nginx vhost configuration</p><pre><code>nano /etc/nginx/sites-available/spotweb</code></pre><p>Here is the Spotweb nginx configuration adapted from <a href="https://github.com/Thermionix/Dockerfiles/blob/master/spotweb/spotweb.nginx.conf" target="_blank" class="external" rel="nofollow">here</a></p><pre><code>server {
	listen 80;
	server_name htpcguides.crabdance.com, 192.168.40.120;
	root /var/www;
	index index.html index.htm index.php;

	location /spotweb {

 satisfy any;

 if ($uri !~ "api/"){
 rewrite /api/?$ /spotweb/index.php?page=newznabapi last;
 }
	location ~ \.php$ {
 try_files $uri =404;
 include fastcgi_params;
 fastcgi_pass unix:/var/run/php5-fpm.sock;
 fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
		}
	}
}</code></pre><p>Disable the default nginx virtual host and enable the nginx Spotweb virtua host</p><pre><code>unlink /etc/nginx/sites-enabled/default
ln -s /etc/nginx/sites-available/spotweb /etc/nginx/sites-enabled/spotweb</code></pre><h3>Install Spotweb on Raspberry&#xA0;Pi</h3><p>Install git so you can get the Spotweb source</p><pre><code>apt-get install git -y</code></pre><p>Grab the latest Spotweb</p><pre><code>git clone https://github.com/spotweb/spotweb /var/www/spotweb</code></pre><p>Change the owner of Spotweb to be www-data so nginx has access to it</p><pre><code>chown -R www-data:www-data /var/www/spotweb</code></pre><p>Restart nginx and php5-fpm</p><pre><code>service nginx restart
service php5-fpm restart</code></pre><h3>Configure Spotweb on Raspberry Pi</h3><p>Go to http://ip.address/spotweb/install.php where&#xA0;ip.address is your Raspberry Pi&#x2019;s&#xA0;IP address to begin configuring Spotweb</p><p>This is the Spotweb php check to make sure you have all the dependencies, click <strong>Next</strong></p><p><a href="http://www.htpcguides.com/wp-content/uploads/2015/06/spotweb-step-1-php.png" class="gallery_colorbox"><img class="alignnone size-medium wp-image-5988" src="" alt="spotweb step 1 php" width="400"></a></p><p>Enter your MySQL database name, username and password we created earlier and click <strong>Verify database</strong></p><p><a href="http://www.htpcguides.com/wp-content/uploads/2015/06/spotweb-step-2-mysql-configuration.png" class="gallery_colorbox"><img class="alignnone wp-image-5993 size-medium" src="" alt="" width="400"></a></p><p>Choose your Usenet server from the dropdown and enter your credentials, click <strong>Verify usenet server</strong></p><p><a href="http://www.htpcguides.com/wp-content/uploads/2015/06/spotweb-step-3-usenet-server.png" class="gallery_colorbox"><img class="alignnone size-medium wp-image-5990" src="" alt="spotweb step 3 usenet server" width="400"></a></p><p>Now it&#x2019;s time to create the site type and an Administrative user. I chose Single user since this is a personal indexer I won&#x2019;t be sharing with anybody, click <strong>Create system</strong> when you are done</p><p><a href="http://www.htpcguides.com/wp-content/uploads/2015/06/spotweb-step-4-users.png" class="gallery_colorbox"><img class="alignnone size-medium wp-image-5991" src="" alt="spotweb step 4 users" width="400"></a></p><p>Installation is now complete</p><p><a href="http://www.htpcguides.com/wp-content/uploads/2015/06/spotweb-step-5-installation-complete.png" class="gallery_colorbox"><img class="alignnone size-medium wp-image-5992" src="" alt="spotweb step 5 installation complete" width="400"></a></p><p>Now navigate to http://ip.address/spotweb and let&#x2019;s start the initial retrieve process</p><p>Click <strong>Config</strong> in the top right and then <strong>Settings</strong></p><p><a href="http://www.htpcguides.com/wp-content/uploads/2015/06/spotweb-click-settings.png" class="gallery_colorbox"><img class="alignnone size-medium wp-image-5994" src="" alt="spotweb click settings" width="400"></a></p><p>Click the <strong>Retrieve</strong> tab</p><p>Set your retrieve settings and then run the initial retrieval manually. It will take a very long time depending on how far back you have chosen to index.</p><p>Move forward in time in the calendar to choose the date from which to index. In the example below spots from March 2015 onwards will be indexed</p><p>Consider unchecking comments as it requires more time to process.</p><p><a href="http://www.htpcguides.com/wp-content/uploads/2015/06/spotweb-change-retrieve-settings.png" class="gallery_colorbox"><img class="alignnone size-medium wp-image-5995" src="" alt="spotweb change retrieve settings" width="400"></a></p><p>Run the Spotweb retrieve in a screen session so you can close the SSH session and still let it run in the background</p><pre><code>sudo apt-get install screen -y</code></pre><p>Enter a screen session</p><pre><code>screen</code></pre><p>Run the Spotweb retrieve script</p><pre><code>php /var/www/spotweb/retrieve.php</code></pre><p>Now you can close the SSH and re-attach the screen session to see how it&#x2019;s doing</p><pre><code>screen -r</code></pre><p>When the initial Spotweb retrieval is done add a cronjob to have your spots updated at a fixed interval. This cronjob checks for new spots&#xA0;every 30 minutes, you can increase or decrease it if you want.</p><p>It will create a fresh log file every&#xA0;hour on the hour at /var/www/spotweb/retrieve.log</p><pre><code>crontab -l | { cat; echo "00 articles _articles bin CAs devops Documents dotfiles gethtml go hnews jason js netdata playground start-thesrc swift thesrc ucii articles _articles bin CAs devops Documents dotfiles gethtml go hnews jason js netdata playground start-thesrc swift thesrc ucii articles _articles bin CAs devops Documents dotfiles gethtml go hnews jason js netdata playground start-thesrc swift thesrc ucii articles _articles bin CAs devops Documents dotfiles gethtml go hnews jason js netdata playground start-thesrc swift thesrc ucii php /var/www/spotweb/retrieve.php &gt; /var/www/spotweb/retrieve.log"; } | crontab -</code></pre><p>When adding Spotweb as an indexer for automation sfotware like Sonarr, SickRage, CouchPotato, Mylar, Headphones, LazyLibrarian and others. Choose newznab as the indexer type. The URL is http://192.168.40.120/spotweb/ where 192.168.40.120 is your Spotweb indexer&#x2019;s IP address.</p><p>You can get your Spotweb API key by clicking your username in the top right corner and choosing <strong>Change User</strong>, scroll down to <strong>API Key</strong> and copy it to the clipboard and paste it in your automation software.</p><p><a href="http://www.htpcguides.com/wp-content/uploads/2015/06/spotweb-show-api-key.png" class="gallery_colorbox"><img class="alignnone wp-image-5997 size-medium" src="" alt="" width="400"></a></p><h3>Move the SQL Database</h3><p>It is a good idea to move your Spotweb MySQL database off the SD card, if you plan on retaining a lot of spots and nzbs you will eventually run out of space on the SD card.</p><p>Stop MySQL and gninx temporarily</p><pre><code>sudo service mysql stop
sudo service nginx stop</code></pre><p>Make a MySQL directory on your USB or SATA drive and change the owner to mysql</p><pre><code>mkdir -p /mnt/usbstorage/mysql
sudo chown -R mysql:mysql /mnt/usbstorage/mysql</code></pre><p>Copy the database over</p><pre><code>cp -r /var/lib/mysql/ /mnt/usbstorage/mysql</code></pre><p>Change the MySQL configuration</p><pre><code>sudo nano /etc/mysql/my.cnf</code></pre><p>Find this line and adjust it to your USB storage path&#x2019;s mysql folder</p><pre><code>datadir &#xA0; &#xA0; &#xA0; &#xA0; = /var/lib/mysql</code></pre><p>Ctrl+X, Y and Enter to Save</p><p>Restart MySQL and nginx</p><pre><code>sudo service mysql restart
sudo service nginx restart</code></pre><p>Spotweb is installed on the Raspberry Pi and you can enjoy your personal Spotweb indexer to browse or use for automation</p></div> </div>
</body></html>
