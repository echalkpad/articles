<!DOCTYPE html><html><head><title>Revel Framework Introduction — Quick Mobile</title></head><body>
<h1>Revel Framework Introduction — Quick Mobile</h1><p><a href="https://medium.com/quick-mobile/revel-framework-introduction-en-700f83ea0c3b" target="_new">Original URL</a></p>
<p><blockquote>When I started programming in GO I thought: “Man, it must be very nice to have a web application based on GO”. Then I started to search how to do it. However, as soon as I realized that it was&hellip;</blockquote></p>
<section name="cd39" class=" section--body section--first section--last" score="41.25"><div class="section-content" score="32.5"><div class="section-inner layoutSingleColumn" score="12.0"><p name="a4f6" id="a4f6" class="graf--p graf-after--h3">When I started programming in GO I thought: “Man, it must be very nice to have a web application based on GO”. Then I started to search how to do it. However, as soon as I realized that it was extremally complicated, I decided to look for a framework to make it easier. That’s how I end up founding Revel, a simple framework that solved my problem. This post is to introduce Revel to newcomers.</p><p name="6cb6" id="6cb6" class="graf--p graf-after--p">Building an environment using GO is a little bit problematic, so I created a docker image. Although, you can always do the old way and install it.</p><p name="49ff" id="49ff" class="graf--p graf-after--p">You can pull my docker image accessing: <a href="https://hub.docker.com/r/walissoncasonatto/revel-docker/" class="markup--anchor markup--p-anchor" rel="nofollow">https://hub.docker.com/r/walissoncasonatto/revel-docker/</a></p><p name="ba99" id="ba99" class="graf--p graf-after--p">Or you can do the old way: <a href="https://revel.github.io/tutorial/gettingstarted.html" class="markup--anchor markup--p-anchor" rel="nofollow">https://revel.github.io/tutorial/gettingstarted.html</a></p><p name="37b8" id="37b8" class="graf--p graf-after--p">If you have chosen to use docker:</p><pre name="81b3" id="81b3" class="graf--pre graf-after--p">$ docker run --name docker-revel -e APP_NAME=myappname -v &lt;path-to-application&gt;:/root/go/src/myapps walissoncasonatto/revel-docker</pre><p name="c8af" id="c8af" class="graf--p graf-after--pre">If you have chosen to install it:</p><pre name="cc02" id="cc02" class="graf--pre graf-after--p">$ Revel new &lt;new_application_name&gt;<br>$ Revel run $GOPATH/src/&lt;new_application_name&gt;</pre><blockquote name="1d29" id="1d29" class="graf--blockquote graf-after--pre">In this case, the app will be stored on the following gopath: $GOPATH/src/&lt;new_application_name&gt;.</blockquote><blockquote name="10f6" id="10f6" class="graf--blockquote graf-after--blockquote">Now it is time to work! <br>We are going to do a simple calculator that gets two numbers and sums them.</blockquote><blockquote name="d68f" id="d68f" class="graf--blockquote graf-after--blockquote">If you have chosen to use Docker, there is a problem that you might have. You can’t change the files created by Docker, because Docker created them as root. Although, it will not be a problem if you run your editor as root or use the following commands to make them editable:</blockquote><blockquote name="732b" id="732b" class="graf--blockquote graf-after--blockquote">find /path/to/base/dir -type d -exec chmod 777 {} +</blockquote><blockquote name="6c89" id="6c89" class="graf--blockquote graf-after--blockquote">find /path/to/base/dir -type f -exec chmod 666 {} +</blockquote><p name="cc62" id="cc62" class="graf--p graf-after--blockquote">There is no need to stop Revel to edit the project, because it is auto-compiled on edit (in dev mode).</p><p name="8acb" id="8acb" class="graf--p graf-after--h4">First, we need to set a route on &lt;app_root&gt;/conf/routes.</p><p name="a93b" id="a93b" class="graf--p graf-after--p">By default it has some routes added, so you can figure out how it works.</p><p name="5ff5" id="5ff5" class="graf--p graf-after--p">We are going to configure it in this way:</p><pre name="6471" id="6471" class="graf--pre graf-after--p"># Routes<br># This file defines all application routes (Higher priority routes first)<br># ~~~~</pre><pre name="b2dd" id="b2dd" class="graf--pre graf-after--pre">module:testrunner</pre><pre name="9d1c" id="9d1c" class="graf--pre graf-after--pre">GET / App.Index<br><strong class="markup--strong markup--pre-strong">GET /calc/ Calc.Index</strong></pre><pre name="8c05" id="8c05" class="graf--pre graf-after--pre"># Ignore favicon requests<br>GET /favicon.ico 404</pre><pre name="358a" id="358a" class="graf--pre graf-after--pre"># Map static resources from the /app/public folder to the /public path<br>GET /public/*filepath Static.Serve(“public”)</pre><pre name="78a7" id="78a7" class="graf--pre graf-after--pre"># Catch all<br>* /:controller/:action :controller.:action</pre><p name="273e" id="273e" class="graf--p graf-after--pre">It has a simple syntax:</p><pre name="2cf8" id="2cf8" class="graf--pre graf-after--p">REQUSEST_TYPE PATH CONTROLLER.ACTION<br>GET / App.Index</pre><p name="8a59" id="8a59" class="graf--p graf-after--h4">Now that we have a route, we can create our controller. It should be located on &lt;app_root_directory&gt;/app/controllers .</p><p name="3a0e" id="3a0e" class="graf--p graf-after--p">Let’s call it calc.go.</p><p name="8a0a" id="8a0a" class="graf--p graf-after--p">We need to add “package controller” in the beginning of our code, and by default all controllers should extend a class Controller located on Revel’s library. The controller name needs to be the same declared on routes file.</p><pre name="53c7" id="53c7" class="graf--pre graf-after--p">package controllers</pre><pre name="0bca" id="0bca" class="graf--pre graf-after--pre">import (<br> “github.com/revel/revel”<br>)</pre><pre name="a1c3" id="a1c3" class="graf--pre graf-after--pre">type Calc struct {<br> *revel.Controller<br>}</pre><p name="9b54" id="9b54" class="graf--p graf-after--pre">Now we should make a method to render the index page. This method is the one called on routes file.</p><pre name="fefc" id="fefc" class="graf--pre graf-after--p">[...]<br>func (c Calc) Index() revel.Result {<br> title := "calculator"<br> return c.Render(title)<br>}</pre><p name="b2ce" id="b2ce" class="graf--p graf-after--pre">Revel pages can receive as many attributes as you want. Let’s do the title be one of the attributes.</p><pre name="81d5" id="81d5" class="graf--pre graf-after--p">package controllers</pre><pre name="681f" id="681f" class="graf--pre graf-after--pre">import (<br> "github.com/revel/revel"<br>)</pre><pre name="4a3d" id="4a3d" class="graf--pre graf-after--pre">type Calc struct {<br> *revel.Controller<br>}</pre><pre name="4830" id="4830" class="graf--pre graf-after--pre">func (c Calc) Index() revel.Result {<br> title := "calculator"<br> return c.Render(title)<br>}</pre><p name="aa60" id="aa60" class="graf--p graf-after--h4">Let’s create a basic one. By default they are located on: /&lt;controller_name&gt;/&lt;action&gt;</p><p name="f684" id="f684" class="graf--p graf-after--p">But first we need to create the calc’s directory on: &lt;app_root_directory&gt;/app/views</p><p name="d070" id="d070" class="graf--p graf-after--p">Inside calc’s directory we can create our Index.html.</p><blockquote name="3e10" id="3e10" class="graf--blockquote graf-after--p">Be careful! GO is a case sensitive language.</blockquote><pre name="542c" id="542c" class="graf--pre graf-after--blockquote">{{template "header.html" .}}</pre><pre name="e345" id="e345" class="graf--pre graf-after--pre">&lt;p&gt; It Works!&lt;/p&gt;</pre><pre name="458b" id="458b" class="graf--pre graf-after--pre">{{template "footer.html" .}}</pre><p name="6675" id="6675" class="graf--p graf-after--h4">Revel has a place to tests, it is located on:</p><p name="f493" id="f493" class="graf--p graf-after--p">&lt;app_root_directory&gt;/tests</p><p name="634a" id="634a" class="graf--p graf-after--p">For now, let’s do the basic. We are going to create a test only to see if the index page is working.</p><pre name="5ba3" id="5ba3" class="graf--pre graf-after--p">package tests</pre><pre name="0c5a" id="0c5a" class="graf--pre graf-after--pre">import (<br> "github.com/revel/revel/testing"<br>)</pre><pre name="7444" id="7444" class="graf--pre graf-after--pre">type CalcTest struct {<br> testing.TestSuite<br>}</pre><pre name="dff8" id="dff8" class="graf--pre graf-after--pre">func (t *CalcTest) Before() {<br> println("Set up")<br>}</pre><pre name="d670" id="d670" class="graf--pre graf-after--pre">func (t *CalcTest) TestCalcPageWork() {<br> t.Get("/calc/")<br> t.AssertOk()<br> t.AssertContentType("text/html; charset=utf-8")<br>}</pre><pre name="c9ff" id="c9ff" class="graf--pre graf-after--pre">func (t *CalcTest) After() {<br> println("Tear down")<br>}</pre><p name="c4bc" id="c4bc" class="graf--p graf-after--pre">Revel test classes should extend testing.TestSuite from Revel library.</p><p name="71cc" id="71cc" class="graf--p graf-after--p">If your Revel still running you can test it, but if it’s not, you might run it again using <em class="markup--em markup--p-em">docker start &lt;your_docker_container_name&gt;</em> or <em class="markup--em markup--p-em">revel run $GOPATH/&lt;project_name&gt;</em></p><blockquote name="569e" id="569e" class="graf--blockquote graf-after--p">Docker is set to do not override your application, so it’s a great opportunity to stop installing applications and start using Docker.</blockquote><p name="4dde" id="4dde" class="graf--p graf-after--blockquote">You can access these links to test it:</p><ul class="postList"><li name="c3a0" id="c3a0" class="graf--li graf-after--p"><a href="http://localhost:9000" class="markup--anchor markup--li-anchor">http://localhost:9000</a></li><li name="2e4b" id="2e4b" class="graf--li graf-after--li"><a href="http://%3Cdocker_ip%3E:9000" class="markup--anchor markup--li-anchor" rel="nofollow">http://docker_ip:9000</a>.</li></ul><p name="b051" id="b051" class="graf--p graf-after--li">We can check our calc out at <a href="http://localhost:9000/calc" class="markup--anchor markup--p-anchor">http://localhost:9000/calc</a> and our tests at <a href="http://localhost:9000/@tests" class="markup--anchor markup--p-anchor">http://localhost:<span class="__cf_email__">[email protected]</span></a>.</p><p name="b10f" id="b10f" class="graf--p graf-after--p">We did the basic, now it’s time to make our calc a real calculator!</p><p name="de60" id="de60" class="graf--p graf-after--p">First we should add a POST route in our calc’s actions.</p><pre name="35ac" id="35ac" class="graf--pre graf-after--p">POST /calc/:action Calc.:action</pre><p name="684e" id="684e" class="graf--p graf-after--pre">By using :action we are making it generic, so any action can be used if the method exists in the controller</p><blockquote name="8611" id="8611" class="graf--blockquote graf-after--p">e.g.: “/calc/Sum” will call the Sum method on Calc’s Controller.</blockquote><p name="7175" id="7175" class="graf--p graf-after--blockquote">Our routes file might look like this:</p><pre name="f863" id="f863" class="graf--pre graf-after--p"># Routes<br># This file defines all application routes (Higher priority routes first)<br># ~~~~</pre><pre name="c61f" id="c61f" class="graf--pre graf-after--pre">module:testrunner</pre><pre name="11e1" id="11e1" class="graf--pre graf-after--pre">GET / App.Index<br>GET /calc/ Calc.Index<br>POST /calc/:action Calc.:action</pre><pre name="4c5f" id="4c5f" class="graf--pre graf-after--pre"># Ignore favicon requests<br>GET /favicon.ico 404</pre><pre name="29cd" id="29cd" class="graf--pre graf-after--pre"># Map static resources from the /app/public folder to the /public path<br>GET /public/*filepath Static.Serve("public")</pre><pre name="1a8d" id="1a8d" class="graf--pre graf-after--pre"># Catch all<br>* /:controller/:action :controller.:action</pre><p name="e88f" id="e88f" class="graf--p graf-after--pre">Now we are able to code our Sum method. It is going to sum two values and redirect the total to the index:</p><pre name="c30b" id="c30b" class="graf--pre graf-after--p">[...]<br>func (c Calc) Sum(number1 int, number2 int) revel.Result {<br> total := number1 + number2<br> return c.Redirect(routes.Calc.Index(total))<br>}</pre><p name="d817" id="d817" class="graf--p graf-after--pre">Our index should receive our total:</p><pre name="c0c0" id="c0c0" class="graf--pre graf-after--p">[...]<br>func (c Calc) Index(total int) revel.Result {<br> title := "calculator"<br> return c.Render(title,total)<br>}<br>[...]</pre><p name="5926" id="5926" class="graf--p graf-after--pre">Probably you noticed that we are using the method <em class="markup--em markup--p-em">routes.Calc.Index </em>without import it. In this way, it will never work! Let’s import it.</p><pre name="20f3" id="20f3" class="graf--pre graf-after--p">package controllers</pre><pre name="f8fc" id="f8fc" class="graf--pre graf-after--pre">import (<br> "github.com/revel/revel"<br> "myapps/webapp2/app/routes"<br>)</pre><blockquote name="c934" id="c934" class="graf--blockquote graf-after--pre">Docker creates a myapps directory before the directory of your application, e.g. my application calls webapp2. If you are using Docker, your application directory might look like mine, but if you are not using Docker you can remove myapps from the path.</blockquote><p name="e879" id="e879" class="graf--p graf-after--blockquote">Our controller should look like this:</p><pre name="17a4" id="17a4" class="graf--pre graf-after--p">package controllers</pre><pre name="e088" id="e088" class="graf--pre graf-after--pre">import (<br> "github.com/revel/revel"<br> "myapps/webapp2/app/routes"<br>)</pre><pre name="d577" id="d577" class="graf--pre graf-after--pre">type Calc struct {<br> *revel.Controller<br>}</pre><pre name="5578" id="5578" class="graf--pre graf-after--pre">func (c Calc) Index(total int) revel.Result {<br> title := "calculator"<br> return c.Render(title,total)<br>}</pre><pre name="fffa" id="fffa" class="graf--pre graf-after--pre">func (c Calc) Sum(number1 int, number2 int) revel.Result {<br> total := number1 + number2<br> return c.Redirect(routes.Calc.Index(total))<br>}</pre><p name="ce21" id="ce21" class="graf--p graf-after--pre">Last but not least, our view:</p><p name="b1a5" id="b1a5" class="graf--p graf-after--p">First we create a POST form to submit our values:</p><pre name="7f7b" id="7f7b" class="graf--pre graf-after--p">&lt;form method="POST"&gt;</pre><pre name="b377" id="b377" class="graf--pre graf-after--pre">&lt;input type="submit" value="Sum" formaction="{{url "Calc.Sum"}}"&gt;<br>&lt;/form&gt;</pre><p name="6ac2" id="6ac2" class="graf--p graf-after--pre">Then we create a table to put our fields:</p><pre name="c3be" id="c3be" class="graf--pre graf-after--p">&lt;table&gt;<br> &lt;th&gt;<br> &lt;td colspan="6"&gt;CALCULATOR&lt;/td&gt;<br> &lt;/th&gt;<br> &lt;tr&gt;<br> &lt;td colspan="2"&gt;<br> &lt;input type="text" name="number1"&gt;<br> &lt;/td&gt;<br> &lt;td colspan="2"&gt;<br> &lt;input type="text" name ="number2"&gt;<br> &lt;/td&gt;<br> &lt;td colspan="2"&gt;<br> &lt;input name="total"&gt;<br> &lt;/td&gt;<br> &lt;/tr&gt;<br> &lt;input type="submit" value="Sum" formaction="{{url "Calc.Sum"}}"&gt;</pre><pre name="18d3" id="18d3" class="graf--pre graf-after--pre">&lt;/table&gt;</pre><p name="1095" id="1095" class="graf--p graf-after--pre">We also need to add the Revel integration. <em class="markup--em markup--p-em">For detailed information, check Revel documentation</em>. It’s going to look like this:</p><pre name="73a9" id="73a9" class="graf--pre graf-after--p">{{template "header.html" .}}<br>&lt;form method="POST"&gt;<br> &lt;table&gt;<br> &lt;th&gt;<br> &lt;td colspan="6"&gt;CALCULATOR&lt;/td&gt;<br> &lt;/th&gt;<br> &lt;tr&gt;<br> {{with $number1 := field "number1" .}}<br> &lt;td colspan="2"&gt;&lt;input type="text" name="{{$number1.Name}}" value = "{{$number1.Value}}" style="width:50px;"&gt;&lt;/td&gt;<br> {{end}}<br> {{with $number2 := field "number2" .}}<br> &lt;td colspan="2"&gt;&lt;input type="text" name ="{{$number2.Name}}" value = "{{$number2.Value}}" style="width:50px;"&gt;&lt;/td&gt;<br> {{end}}<br> {{with $total := field "total" .}}<br> &lt;td colspan="2"&gt;&lt;input name="{{$total.Name}}" value = "{{$total.Value}}" readonly="readonly" style="width:50px;"&gt;&lt;/td&gt;<br> {{end}}<br> &lt;/tr&gt;<br> &lt;/table&gt;<br> &lt;input type="submit" value="Sum" formaction="{{url "Calc.Sum"}}"&gt;<br>&lt;/form&gt;<br>{{template "footer.html" .}}</pre><p name="c7ee" id="c7ee" class="graf--p graf-after--pre">That’s all! We can access our calculator and check it working.</p><p name="bdae" id="bdae" class="graf--p graf-after--h4">Revel doesn’t have UnitTest support yet, but once it is a GO application you can use an GO library to test.</p><p name="f8df" id="f8df" class="graf--p graf-after--p">It is also possible to implement unittests using revel interface, however you can not get some important data like coverage or make it automated.</p><p name="d02c" id="d02c" class="graf--p graf-after--p">Let’s add another test:</p><p name="7713" id="7713" class="graf--p graf-after--p">First we extract the Sum logic to make it testable:</p><pre name="15c2" id="15c2" class="graf--pre graf-after--p">[...]<br>func (c Calc) Sum(number1 int, number2 int) revel.Result {<br> total := c.DoSum(number1,number2)<br> return c.Redirect(routes.Calc.Index(total))<br>}<br>func (c Calc) DoSum(number1 int, number2 int) int{<br> return number1+number2<br>}</pre><p name="b2c6" id="b2c6" class="graf--p graf-after--pre">On our test class we import the controllers:</p><pre name="f204" id="f204" class="graf--pre graf-after--p">package tests</pre><pre name="bbdb" id="bbdb" class="graf--pre graf-after--pre">import (<br> "github.com/revel/revel/testing"<br> "myapps/webapp2/app/controllers"<br>)</pre><p name="78a5" id="78a5" class="graf--p graf-after--pre">We need to add an attribute to represent the Calc controller:</p><pre name="199e" id="199e" class="graf--pre graf-after--p">type CalcTest struct {<br> testing.TestSuite<br> calc controllers.Calc<br>}</pre><p name="c472" id="c472" class="graf--p graf-after--pre">And now that we can code a method to test DoSum:</p><pre name="1aff" id="1aff" class="graf--pre graf-after--p">func (t *CalcTest) TestDoSum(){<br> expected := 10<br> current := t.calc.DoSum(3,7)<br> t.Assert(expected == current)<br>}</pre><p name="7354" id="7354" class="graf--p graf-after--pre">By the end, our test’s class end up like this:</p><pre name="4ecd" id="4ecd" class="graf--pre graf-after--p">package tests<br>import (<br> "github.com/revel/revel/testing"<br> "myapps/webapp2/app/controllers"<br>)</pre><pre name="ee78" id="ee78" class="graf--pre graf-after--pre">type CalcTest struct {<br> testing.TestSuite<br> calc controllers.Calc<br>}</pre><pre name="07e1" id="07e1" class="graf--pre graf-after--pre">func (t *CalcTest) Before() {<br> println("Set up")<br>}</pre><pre name="be79" id="be79" class="graf--pre graf-after--pre">func (t *CalcTest) TestCalcPageWork() {<br> t.Get("/calc/")<br> t.AssertOk()<br> t.AssertContentType("text/html; charset=utf-8")<br>}</pre><pre name="4bd3" id="4bd3" class="graf--pre graf-after--pre">func (t *CalcTest) TestDoSum(){<br> expected := 10<br> current := t.calc.DoSum(3,7)<br> t.Assert(expected == current)<br>}</pre><pre name="969f" id="969f" class="graf--pre graf-after--pre">func (t *CalcTest) After() {<br> println("Tear down")<br>}</pre><p name="8e68" id="8e68" class="graf--p graf-after--pre">That’s all!</p><p name="0696" id="0696" class="graf--p graf-after--p graf--last">I believe you are introduced enough to make the subtraction method and the damn tests.</p></div></div></section>
</body></html>
