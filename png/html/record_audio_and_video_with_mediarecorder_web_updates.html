<!DOCTYPE html><html><head><title>Record audio and video with MediaRecorder | Web Updates</title></head><body>
<h1>Record audio and video with MediaRecorder | Web Updates</h1><p><a href="https://developers.google.com/web/updates/2016/01/mediarecorder?hl=en" target="_new">Original URL</a></p>
<p><blockquote>Break out the champagne and doughnuts! The most starred Chrome feature EVER has now been implemented.Imagine a ski-run recorder that synchronizes video with GeoLocation data, or a super-simple voice&hellip;</blockquote></p>
<div><div class="page-content"></div><div class="page-content"><p class="intro">Break out the champagne and doughnuts! The <a href="https://code.google.com/p/chromium/issues/detail?id=113676">most starred</a> Chrome feature EVER has now been implemented.</p><p>Imagine a ski-run recorder that synchronizes video with GeoLocation data, or a super-simple voice memo app, or a widget that enables you to record a video and upload it to YouTube &#x2014; all without plugins.</p><p>The <a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaRecorder_API">MediaRecorder API</a> enables you to record audio and video from a web app. It&#x2019;s available now in Firefox and in Chrome for Android and desktop.</p><p>Try it out <a href="https://webrtc.github.io/samples/src/content/getusermedia/record">here</a>.</p><p><img class="screenshot" src="https://developers.google.com/web/updates/images/2016/01/mediarecorder/screenshot.jpg" alt="Screenshot of mediaRecorder demo on Android Nexus 5X"></p><blockquote><p><strong>A word about support</strong>:</p><p>&#x2022; To use MediaRecorder in Chrome 47 and 48, enable <strong>experimental Web Platform features</strong> from the chrome://flags page.</p><p>&#x2022; Audio recording work in Firefox and in Chrome 49 and above; Chrome 47 and 48 only support video recording.</p><p>&#x2022; In Chrome on Android you can save and download recordings made with MediaRecorder, but it&#x2019;s not yet possible to view a recording in a video element via <code>window.URL.createObjectURL()</code>. See <a href="https://code.google.com/p/chromium/issues/detail?id=253465">this bug</a>.</p></blockquote><p>The API is straightforward, which I&#x2019;ll demonstrate using code from the <a href="https://webrtc.github.io/samples/src/content/getusermedia/record">WebRTC sample repo demo</a>. Note that the API can only be used from <a href="https://www.chromium.org/Home/chromium-security/deprecating-powerful-features-on-insecure-origins">secure origins only</a>: HTTPS or localhost.</p><p>First up, instantiate a MediaRecorder with a MediaStream. Optionally, use an <code>options</code> parameter to specify the desired output format:</p><div class="highlight"><pre><code class="language-javascript"><span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span><span class="nx">mimeType</span><span class="o">:</span> <span class="s1">'video/webm, codecs=vp9'</span><span class="p">};</span>
<span class="nx">mediaRecorder</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MediaRecorder</span><span class="p">(</span><span class="nx">stream</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span></code></pre></div><p>The MediaStream can be from:</p><ul><li>A <code>getUserMedia()</code> call.</li><li>The receiving end of a WebRTC call.</li><li>A screen recording.</li><li>Web Audio, once <a href="https://codereview.chromium.org/1579693006">this issue</a> is implemented.</li></ul><p>For <code>options</code> it&#x2019;s possible to specify the <a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaRecorder/MediaRecorder">MIME type</a> and, in the future, audio and video <a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaRecorder/MediaRecorder">bitrates</a>.</p><p>MIME types have more or less specific values, combining container and codecs. For example:</p><ul><li>audio/webm</li><li>video/webm</li><li>video/webm;codecs=vp8</li><li>video/webm;codecs=vp9</li></ul><p>Use the static method <code>MediaRecoder.isTypeSupported()</code> to check if a MIME type is supported, for example when you instantiate MediaRecorder:</p><div class="highlight"><pre><code class="language-javascript"><span class="kd">var</span> <span class="nx">options</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">MediaRecorder</span><span class="p">.</span><span class="nx">isTypeSupported</span><span class="p">(</span><span class="s1">'video/webm;codecs=vp9'</span><span class="p">))</span> <span class="p">{</span>
 <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span><span class="nx">mimeType</span><span class="o">:</span> <span class="s1">'video/webm, codecs=vp9'</span><span class="p">};</span>
<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">MediaRecorder</span><span class="p">.</span><span class="nx">isTypeSupported</span><span class="p">(</span><span class="s1">'video/webm;codecs=vp8'</span><span class="p">))</span> <span class="p">{</span>
 <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span><span class="nx">mimeType</span><span class="o">:</span> <span class="s1">'video/webm, codecs=vp8'</span><span class="p">};</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
 <span class="c1">// ...</span>
<span class="p">}</span></code></pre></div><p>The full list of MIME types supported by MediaRecorder in Chrome is available <a href="https://code.google.com/p/chromium/codesearch#chromium/src/third_party/WebKit/LayoutTests/fast/mediarecorder/MediaRecorder-isTypeSupported.html">here</a>.</p><blockquote><p><strong>Beware:</strong> Instantiation will fail if the browser doesn&#x2019;t support the MIME type specified, so use <code>MediaRecoder.isTypeSupported()</code> or try/catch &#x2014; or leave out the <code>options</code> argument if you&#x2019;re happy with the browser default.</p></blockquote><p>Next, add a data handler and call the <code>start()</code> method to begin recording:</p><div class="highlight"><pre><code class="language-javascript"><span class="kd">var</span> <span class="nx">recordedChunks</span> <span class="o">=</span> <span class="p">[];</span>

<span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span><span class="nx">mimeType</span><span class="o">:</span> <span class="s1">'video/webm,codecs=vp9'</span><span class="p">};</span>
<span class="nx">mediaRecorder</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MediaRecorder</span><span class="p">(</span><span class="nx">stream</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
<span class="nx">mediaRecorder</span><span class="p">.</span><span class="nx">ondataavailable</span> <span class="o">=</span> <span class="nx">handleDataAvailable</span><span class="p">;</span>
<span class="nx">mediaRecorder</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>

<span class="kd">function</span> <span class="nx">handleDataAvailable</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
 <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
 <span class="nx">recordedChunks</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
 <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
 <span class="c1">// ...</span>
 <span class="p">}</span>
<span class="p">}</span></code></pre></div><p>This examples adds a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Blob">Blob</a> to the <code>recordedChunks</code> array whenever data becomes available. The <code>start()</code> method can optionally be given a <code>timeSlice</code> argument that specifies the length of media to capture for each Blob.</p><p>When you&#x2019;ve finished recording, tell the MediaRecorder:</p><p>Play the recorded Blobs in a video element by creating a &#x2018;super-Blob&#x2019; from the array of recorded Blobs:</p><div class="highlight"><pre><code class="language-javascript"><span class="kd">function</span> <span class="nx">play</span><span class="p">()</span> <span class="p">{</span>
 <span class="kd">var</span> <span class="nx">superBuffer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Blob</span><span class="p">(</span><span class="nx">recordedChunks</span><span class="p">);</span>
 <span class="nx">videoElement</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span>
 <span class="nb">window</span><span class="p">.</span><span class="nx">URL</span><span class="p">.</span><span class="nx">createObjectURL</span><span class="p">(</span><span class="nx">superBuffer</span><span class="p">);</span>
<span class="p">}</span></code></pre></div><p>Alternatively, you could upload to a server via XHR, or use an API like <a href="https://developers.google.com/youtube/v3/code_samples/javascript#upload_video">YouTube</a> (see <a href="https://jeffy.info/google-youtube-upload/components/google-youtube-upload/demo/">the experimental demo</a> below).</p><p>Download can be achieved with some link hacking:</p><div class="highlight"><pre><code class="language-javascript"><span class="kd">function</span> <span class="nx">download</span><span class="p">()</span> <span class="p">{</span>
 <span class="kd">var</span> <span class="nx">blob</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Blob</span><span class="p">(</span><span class="nx">recordedChunks</span><span class="p">,</span> <span class="p">{</span>
 <span class="nx">type</span><span class="o">:</span> <span class="s1">'video/webm'</span>
 <span class="p">});</span>
 <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">URL</span><span class="p">.</span><span class="nx">createObjectURL</span><span class="p">(</span><span class="nx">blob</span><span class="p">);</span>
 <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'a'</span><span class="p">);</span>
 <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
 <span class="nx">a</span><span class="p">.</span><span class="nx">style</span> <span class="o">=</span> <span class="s1">'display: none'</span><span class="p">;</span>
 <span class="nx">a</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">url</span><span class="p">;</span>
 <span class="nx">a</span><span class="p">.</span><span class="nx">download</span> <span class="o">=</span> <span class="s1">'test.webm'</span><span class="p">;</span>
 <span class="nx">a</span><span class="p">.</span><span class="nx">click</span><span class="p">();</span>
 <span class="nb">window</span><span class="p">.</span><span class="nx">URL</span><span class="p">.</span><span class="nx">revokeObjectURL</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
<span class="p">}</span></code></pre></div><h2 id="feedback-on-the-apis-and-demos">Feedback on the APIs and demos</h2><p>The ability to record audio and video without plugins is relatively new to web apps, so we particularly appreciate your feedback on the APIs.</p><p>We&#x2019;d also like to know what usage scenarios are most important to you, and what features you would like us to prioritize. Comment on this article or track progress at <a href="https://crbug.com/262211">crbug.com/262211</a>.</p><h2 id="demos">Demos</h2><h2 id="apps">Apps</h2><ul><li>Paul Lewis&#x2019;s <a href="https://voice-memos.appspot.com/">Voice Memos</a> app now has MediaRecorder support, polyfilled for browsers that don&#x2019;t support MediaRecorder audio.</li></ul><h2 id="polyfills">Polyfills</h2><ul><li>Muaz Khan&#x2019;s <a href="https://www.webrtc-experiment.com/msr/">MediaStreamRecorder</a> is a JavaScript library for recording audio and video, compatible with MediaRecorder.</li><li><a href="https://github.com/mattdiamond/Recorderjs">Recorderjs</a> enables recording from a Web Audio API node. You can see this in action in Paul Lewis&#x2019;s <a href="https://voice-memos.appspot.com/">Voice Memos</a> app.</li></ul><h2 id="browser-support">Browser support</h2><ul><li>Chrome 49 and above by default</li><li>Chrome desktop 47 and 48 with Experimental Web Platform features enabled from chrome://flags</li><li>Firefox from version 25</li><li><a href="https://dev.windows.com/en-us/microsoft-edge/platform/status/mediarecorder">Edge</a>: &#x2018;Under Consideration&#x2019;</li></ul><h2 id="spec">Spec</h2><p><a href="https://w3c.github.io/mediacapture-record/MediaRecorder.html">w3c.github.io/mediacapture-record/MediaRecorder.html</a></p><p><a href="https://developer.mozilla.org/en/docs/Web/API/MediaRecorder_API">developer.mozilla.org/en/docs/Web/API/MediaRecorder_API</a></p><div class="wf-author__container mdl-grid page-content"><h6 class="mdl-cell--12-col">Authors</h6></div><div class="wf-license-translation page-content"><p class="wf-cc-license">Except as otherwise noted, the content of this page is licensed under the <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0 License</a>, and code samples are licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 License</a>. For details, see our <a href="https://developers.google.com/site-terms">Terms of Service</a>.</p></div></div></div>
</body></html>
